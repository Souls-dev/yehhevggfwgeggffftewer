local SoulsHub = loadstring(game:HttpGet("https://pandadevelopment.net/virtual/file/e7f388d3c065df7a"))()

task.wait(1)

SoulsHub:Loader(nil, 1).yield()

local FileWatcher = SoulsHub:ConfigManager({
    Directory = "SoulsHub",
    Config = "FishIt_Configs"    
})

local Window = SoulsHub.new({
    Keybind = "LeftControl",
})

-- Custom Theme Colors - Professional Ocean Theme
SoulsHub:ChangeHighlightColor(Color3.fromRGB(85, 235, 169)) -- Teal accent color
SoulsHub.Colors.Background = Color3.fromRGB(24, 28, 36)
SoulsHub.Colors.Container = Color3.fromRGB(36, 42, 52)
SoulsHub.Colors.Text = Color3.fromRGB(240, 248, 255)
SoulsHub.Colors.Disabled = Color3.fromRGB(80, 85, 95)
SoulsHub.Colors.Border = Color3.fromRGB(65, 105, 225) -- Royal Blue

local watermark = Window:Watermark()

watermark:AddText({
    Icon = "fish",
    Text = "Souls Hub Pro"
})

local vim = watermark:AddText({
    Icon = "clock",
    Text = SoulsHub:GetTimeNow()
})

task.spawn(function()
    while true do task.wait()
        vim:SetText(SoulsHub:GetTimeNow())
    end
end)

watermark:AddText({
    Icon = "server",
    Text = game.JobId
})

Window:Update({
    ExpireDate = SoulsHub:GetDate(tick() + 86400)
})

-- Tabs Creation with proper icons
local Home = Window:DrawTab({
    Icon = "home",
    Name = "Home"
})

local Farm = Window:DrawTab({
    Icon = "fish",
    Name = "Farming"
})

local SmartFarm = Window:DrawTab({
    Icon = "brain",
    Name = "Smart Farm"
})

local Auto = Window:DrawTab({
    Icon = "repeat",
    Name = "Automation"
})

local Shop = Window:DrawTab({
    Icon = "shopping-cart",
    Name = "Shop"
})

local Boat = Window:DrawTab({
    Icon = "sailboat",
    Name = "Boats"
})

local Player = Window:DrawTab({
    Icon = "user",
    Name = "Player"
})

local Teleport = Window:DrawTab({
    Icon = "map-pin",
    Name = "Navigation"
})

local Server = Window:DrawTab({
    Icon = "server",
    Name = "Server"
})

-- Home Tab Sections
local homeLeft = Home:DrawSection({
    Name = "Welcome",
    Position = "left"
})

local homeRight = Home:DrawSection({
    Name = "Update Notes",
    Position = "right"
})

homeLeft:AddParagraph({
    Title = "Welcome to Souls Hub Pro",
    Content = "The ultimate Roblox Fish It! automation tool.\nProfessional-grade features with advanced anti-ban\nprotection and optimized performance."
})

homeLeft:AddParagraph({
    Title = "Version",
    Content = "v2.1.0 - Professional Edition"
})

homeRight:AddParagraph({
    Title = "Latest Update",
    Content = "[+] Fixed Lag Reduction System\n[+] Working Auto Fishing & Selling\n[+] Money Detection System\n[+] Equipment Database Updated\n[+] Smart Farm Status Display\n[+] Anti-Ban Protection Enhanced"
})

homeRight:AddButton({
    Name = "Join Community",
    Callback = function()
        setclipboard("discord.gg/soulshub")
        Window:AddNotification({
            Title = "Copied!",
            Content = "Community link copied to clipboard",
            Duration = 3
        })
    end
})

-- Farming Tab Sections - Working Auto Fishing System
local farmLeft = Farm:DrawSection({
    Name = "Fishing System",
    Position = "left"
})

local farmRight = Farm:DrawSection({
    Name = "Management",
    Position = "right"
})

-- Advanced Auto Fishing System - Using Working Snippet
local autoFishToggle = farmLeft:AddToggle({
    Name = "Advanced Auto Fishing",
    Default = false,
    Flag = "advanced_auto_fish",
    Callback = function(state)
        getgenv().AdvancedFishing = state
        if state then
            task.spawn(function()
                while getgenv().AdvancedFishing do
                    pcall(function()
                        local ReplicatedStorage = game:GetService("ReplicatedStorage")
                        local NetFolder = ReplicatedStorage:WaitForChild("Packages"):WaitForChild("_Index"):WaitForChild("sleitnick_net@0.2.0"):WaitForChild("net")
                        
                        local EquipToolEvent = NetFolder:FindFirstChild("RE/EquipToolFromHotbar")
                        local ChargeFishingRodEvent = NetFolder:FindFirstChild("RF/ChargeFishingRod")
                        local RequestMinigameEvent = NetFolder:FindFirstChild("RF/RequestFishingMinigameStarted")
                        local FishingCompletedEvent = NetFolder:FindFirstChild("RE/FishingCompleted")
                        
                        -- Verify all remotes exist
                        if not (EquipToolEvent and ChargeFishingRodEvent and RequestMinigameEvent and FishingCompletedEvent) then
                            Window:AddNotification({
                                Title = "Error",
                                Content = "Missing fishing remotes. Please restart script.",
                                Duration = 5
                            })
                            getgenv().AdvancedFishing = false
                            return
                        end
                        
                        -- Equip fishing rod from slot 1
                        EquipToolEvent:FireServer(1)
                        task.wait(0.5)
                        
                        -- Charge fishing rod with current time
                        local currentTime = tick()
                        ChargeFishingRodEvent:InvokeServer(nil, nil, nil, currentTime)
                        task.wait(0.2)
                        
                        -- Request minigame with optimized coordinates for perfect catch
                        local perfectX = -0.57187455892563
                        local perfectY = 0.98649686980755
                        
                        RequestMinigameEvent:InvokeServer(
                            perfectX,
                            perfectY,
                            currentTime
                        )
                        
                        -- Wait for minigame completion
                        task.wait(2.5)
                        
                        -- Complete fishing
                        FishingCompletedEvent:FireServer()
                        
                        -- Adaptive delay with anti-ban protection
                        local baseDelay = 1.0
                        local randomDelay = math.random() * 0.3
                        task.wait(baseDelay + randomDelay)
                    end)
                end
                
                -- Cleanup when disabled
                pcall(function()
                    local ReplicatedStorage = game:GetService("ReplicatedStorage")
                    local NetFolder = ReplicatedStorage:WaitForChild("Packages"):WaitForChild("_Index"):WaitForChild("sleitnick_net@0.2.0"):WaitForChild("net")
                    local CancelFishingInputs = NetFolder:FindFirstChild("RF/CancelFishingInputs")
                    
                    if CancelFishingInputs then
                        CancelFishingInputs:InvokeServer()
                    end
                end)
            end)
        else
            -- Force cleanup
            pcall(function()
                local player = game.Players.LocalPlayer
                local char = player.Character
                if char then
                    for _, obj in ipairs(char:GetDescendants()) do
                        if obj:IsA("BodyVelocity") or obj:IsA("BodyGyro") then
                            obj:Destroy()
                        end
                    end
                end
                -- Re-enable fishing rod
                local ReplicatedStorage = game:GetService("ReplicatedStorage")
                local Net = ReplicatedStorage:WaitForChild("Packages"):WaitForChild("_Index"):WaitForChild("sleitnick_net@0.2.0"):WaitForChild("net")
                local unequipTool = Net:WaitForChild("RE/UnequipToolFromHotbar")
                if unequipTool then
                    unequipTool:FireServer()
                end
            end)
        end
    end
})

-- Auto Sell System
local autoSellToggle = farmRight:AddToggle({
    Name = "Auto Sell Items",
    Default = false,
    Flag = "auto_sell_items",
    Callback = function(state)
        getgenv().AutoSellItems = state
        if state then
            task.spawn(function()
                while getgenv().AutoSellItems do
                    pcall(function()
                        local ReplicatedStorage = game:GetService("ReplicatedStorage")
                        local Net = ReplicatedStorage:WaitForChild("Packages"):WaitForChild("_Index"):WaitForChild("sleitnick_net@0.2.0"):WaitForChild("net")
                        local sellAll = Net:WaitForChild("RF/SellAllItems")
                        if sellAll then
                            sellAll:InvokeServer()
                        end
                    end)
                    task.wait(getgenv().SellInterval or 3)
                end
            end)
        end
    end
})

-- Sell Settings
farmRight:AddSlider({
    Name = "Sell Interval",
    Min = 1,
    Max = 30,
    Default = 3,
    Step = 1,
    Flag = "sell_interval",
    Callback = function(value)
        getgenv().SellInterval = value
    end
})

-- Equipment Management - FIXED AUTO EQUIP SYSTEM
farmLeft:AddToggle({
    Name = "Smart Auto Equip Rod",
    Default = false,
    Flag = "auto_equip_best_rod",
    Callback = function(state)
        getgenv().AutoEquipBestRod = state
        if state then
            task.spawn(function()
                while getgenv().AutoEquipBestRod do
                    pcall(function()
                        local player = game.Players.LocalPlayer
                        local char = player.Character
                        local hasRod = false
                        
                        if char then
                            -- Check if we already have a rod equipped
                            if char:FindFirstChild("!!!FISHING_VIEW_MODEL!!!") then
                                hasRod = true
                            else
                                -- Check tools in character
                                for _, child in ipairs(char:GetChildren()) do
                                    if child:IsA("Tool") and child:FindFirstChild("Rod") then
                                        hasRod = true
                                        break
                                    end
                                end
                            end
                        end
                        
                        -- Only equip if we don't have a rod
                        if not hasRod then
                            local ReplicatedStorage = game:GetService("ReplicatedStorage")
                            local Net = ReplicatedStorage:WaitForChild("Packages"):WaitForChild("_Index"):WaitForChild("sleitnick_net@0.2.0"):WaitForChild("net")
                            
                            -- Try to equip from hotbar (slots 1-5)
                            local equipTool = Net:WaitForChild("RE/EquipToolFromHotbar")
                            if equipTool then
                                -- Try different slots with fallback
                                local equipped = false
                                for slot = 1, 5 do
                                    equipTool:FireServer(slot)
                                    task.wait(0.2)
                                    
                                    -- Check if equipped successfully
                                    local char = player.Character
                                    if char and char:FindFirstChild("!!!FISHING_VIEW_MODEL!!!") then
                                        equipped = true
                                        break
                                    end
                                end
                            end
                        end
                    end)
                    task.wait(2)
                end
            end)
        end
    end
})

-- Farming Statistics
farmRight:AddParagraph({
    Title = "Farming Stats",
    Content = "Fish Caught: 0\nTotal Value: 0 coins"
})

-- Smart Farm Tab - The Advanced Auto-Farm System
local smartLeft = SmartFarm:DrawSection({
    Name = "Smart Farming",
    Position = "left"
})

local smartRight = SmartFarm:DrawSection({
    Name = "Economy",
    Position = "right"
})

-- Money detection function - multiple fallbacks
local function getPlayerMoney()
    -- Method 1: Try to get from Inventory UI
    local player = game.Players.LocalPlayer
    local playerGui = player:FindFirstChild("PlayerGui")
    if playerGui then
        local inventory = playerGui:FindFirstChild("Inventory")
        if inventory then
            local main = inventory:FindFirstChild("Main")
            if main then
                local top = main:FindFirstChild("Top")
                if top then
                    local info = top:FindFirstChild("Info")
                    if info then
                        local amountLabel = info:FindFirstChild("Amount")
                        if amountLabel and amountLabel.Text then
                            local text = amountLabel.Text
                            -- Remove currency symbol and commas
                            text = text:gsub("â‚¿", ""):gsub(",", "")
                            local num = tonumber(text)
                            if num then
                                return num
                            end
                        end
                    end
                end
            end
        end
    end
    
    -- Method 2: Try to get from Backpack UI
    if playerGui then
        local backpack = playerGui:FindFirstChild("Backpack")
        if backpack then
            local main = backpack:FindFirstChild("Main")
            if main then
                local top = main:FindFirstChild("Top")
                if top then
                    local info = top:FindFirstChild("Info")
                    if info then
                        local amountLabel = info:FindFirstChild("Amount")
                        if amountLabel and amountLabel.Text then
                            local text = amountLabel.Text
                            text = text:gsub("â‚¿", ""):gsub(",", "")
                            local num = tonumber(text)
                            if num then
                                return num
                            end
                        end
                    end
                end
            end
        end
    end
    
    -- Method 3: Fallback to default if UI elements not found
    return 0
end

-- Smart Farm Status Display
local currentStatus = smartLeft:AddParagraph({
    Title = "Farm Status",
    Content = "Status: Stopped\nMoney: 0\nCurrent Rod: Starter Rod\nCurrent Bait: Starter Bait"
})

-- Rod and Bait database with stats from user-provided data
local RodDatabase = {
    [1] = {Name = "Starter Rod", Cost = 0, Luck = 0, Speed = 0, MaxWeight = 10, Rarity = "Common"},
    [4] = {Name = "Luck Rod", Cost = 250, Luck = 50, Speed = 2, MaxWeight = 15, Rarity = "Common"},
    [76] = {Name = "Carbon Rod", Cost = 900, Luck = 30, Speed = 4, MaxWeight = 20, Rarity = "Common"},
    [85] = {Name = "Grass Rod", Cost = 1500, Luck = 55, Speed = 5, MaxWeight = 250, Rarity = "Uncommon"},
    [77] = {Name = "Demascus Rod", Cost = 3000, Luck = 80, Speed = 4, MaxWeight = 400, Rarity = "Uncommon"},
    [78] = {Name = "Ice Rod", Cost = 5000, Luck = 60, Speed = 7, MaxWeight = 750, Rarity = "Uncommon"},
    [80] = {Name = "Midnight Rod", Cost = 50000, Luck = 100, Speed = 10, MaxWeight = 10000, Rarity = "Rare"},
    [5] = {Name = "Fluorescent Rod", Cost = 715000, Luck = 300, Speed = 23, MaxWeight = 160000, Rarity = "Legendary"},
    [6] = {Name = "Astral Rod", Cost = 1000000, Luck = 350, Speed = 43, MaxWeight = 350000, Rarity = "Legendary"},
    [7] = {Name = "Hazmat Rod", Cost = 1300000, Luck = 380, Speed = 32, MaxWeight = 300000, Rarity = "Legendary"},
    [9] = {Name = "Ares Rod", Cost = 3000000, Luck = 455, Speed = 56, MaxWeight = 400000, Rarity = "Mythic"},
    [10] = {Name = "Angler Rod", Cost = 8000000, Luck = 530, Speed = 71, MaxWeight = 500000, Rarity = "Mythic"}
}

local BaitDatabase = {
    [10] = {Name = "Starter Bait", Cost = 100, Luck = 0},
    [2] = {Name = "Topwater Bait", Cost = 100, Luck = 0},
    [3] = {Name = "Luck Bait", Cost = 1000, Luck = 10},
    [4] = {Name = "Midnight Bait", Cost = 3500, Luck = 20},
    [6] = {Name = "Chroma Bait", Cost = 290000, Luck = 100},
    [8] = {Name = "Dark Matter Bait", Cost = 630000, Luck = 160},
    [15] = {Name = "Corrupt Bait", Cost = 1150000, Luck = 200},
    [16] = {Name = "Aether Bait", Cost = 3700000, Luck = 240}
}

-- Function to calculate rod efficiency score
local function calculateRodScore(rod)
    if not rod then return 0 end
    -- Weight luck more heavily than speed
    return (rod.Luck * 0.7) + (rod.Speed * 0.3)
end

-- Function to calculate bait efficiency score
local function calculateBaitScore(bait)
    if not bait then return 0 end
    return bait.Luck
end

-- Function to calculate total efficiency score (rod + bait)
local function calculateTotalScore(rod, bait)
    return (calculateRodScore(rod) * 0.7) + (calculateBaitScore(bait) * 0.3)
end

-- Function to find best affordable rod
local function findBestAffordableRod(budget, currentRodId)
    local bestScore = 0
    local bestRodId = currentRodId
    
    local currentRod = currentRodId and RodDatabase[currentRodId] or RodDatabase[1]
    local currentScore = calculateRodScore(currentRod)
    
    for rodId, rod in pairs(RodDatabase) do
        if rod.Cost <= budget then
            local newScore = calculateRodScore(rod)
            if newScore > bestScore and newScore > currentScore then
                bestScore = newScore
                bestRodId = rodId
            end
        end
    end
    
    return bestRodId, bestScore
end

-- Function to find best affordable bait
local function findBestAffordableBait(budget, currentBaitId)
    local bestScore = 0
    local bestBaitId = currentBaitId
    
    local currentBait = currentBaitId and BaitDatabase[currentBaitId] or BaitDatabase[10]
    local currentScore = calculateBaitScore(currentBait)
    
    for baitId, bait in pairs(BaitDatabase) do
        if bait.Cost <= budget then
            local newScore = calculateBaitScore(bait)
            if newScore > bestScore and newScore > currentScore then
                bestScore = newScore
                bestBaitId = baitId
            end
        end
    end
    
    return bestBaitId, bestScore
end

-- Helper function to format money with commas
local function formatMoney(amount)
    local formatted = tostring(math.floor(amount))
    while true do
        formatted, k = string.gsub(formatted, "^(-?%d+)(%d%d%d)", '%1,%2')
        if k == 0 then break end
    end
    return formatted
end

-- Function to purchase rod
local function purchaseRod(rodId)
    pcall(function()
        local ReplicatedStorage = game:GetService("ReplicatedStorage")
        local Net = ReplicatedStorage:WaitForChild("Packages"):WaitForChild("_Index"):WaitForChild("sleitnick_net@0.2.0"):WaitForChild("net")
        local purchaseRod = Net:WaitForChild("RF/PurchaseFishingRod")
        if purchaseRod then
            purchaseRod:InvokeServer(rodId)
        end
    end)
end

-- Function to purchase bait
local function purchaseBait(baitId)
    pcall(function()
        local ReplicatedStorage = game:GetService("ReplicatedStorage")
        local Net = ReplicatedStorage:WaitForChild("Packages"):WaitForChild("_Index"):WaitForChild("sleitnick_net@0.2.0"):WaitForChild("net")
        local purchaseBait = Net:WaitForChild("RF/PurchaseBait")
        if purchaseBait then
            purchaseBait:InvokeServer(baitId)
        end
    end)
end

-- Smart Farm Toggle
local smartFarmToggle = smartLeft:AddToggle({
    Name = "Enable Smart Farm",
    Default = false,
    Flag = "smart_farm_enabled",
    Callback = function(state)
        getgenv().SmartFarmEnabled = state
        if state then
            task.spawn(function()
                while getgenv().SmartFarmEnabled do
                    pcall(function()
                        -- Get current money
                        currentMoney = getPlayerMoney()
                        
                        -- Get current equipment
                        local currentRodId = getgenv().CurrentRodId or 1
                        local currentBaitId = getgenv().CurrentBaitId or 10
                        
                        -- Find best affordable upgrades
                        local bestRodId, rodScore = findBestAffordableRod(currentMoney, currentRodId)
                        local bestBaitId, baitScore = findBestAffordableBait(currentMoney, currentBaitId)
                        
                        -- Execute purchases if better options found
                        if bestRodId ~= currentRodId then
                            purchaseRod(bestRodId)
                            getgenv().CurrentRodId = bestRodId
                        end
                        
                        if bestBaitId ~= currentBaitId then
                            purchaseBait(bestBaitId)
                            getgenv().CurrentBaitId = bestBaitId
                        end
                        
                        -- Update status display
                        local rodName = currentRodId and RodDatabase[currentRodId].Name or "None"
                        local baitName = currentBaitId and BaitDatabase[currentBaitId].Name or "None"
                        local statusText = string.format("Status: Active\nMoney: â‚¿%s\nCurrent Rod: %s\nCurrent Bait: %s", 
                            formatMoney(currentMoney), 
                            rodName,
                            baitName)
                        currentStatus:SetContent(statusText)
                    end)
                    task.wait(10) -- Check every 10 seconds
                end
            end)
        else
            -- Update status when disabled
            currentStatus:SetContent("Status: Stopped\nMoney: N/A\nCurrent Rod: N/A\nCurrent Bait: N/A")
        end
    end
})

-- Economy Statistics
smartRight:AddParagraph({
    Title = "Economy Stats",
    Content = "Profit/Hour: 0\nTotal Caught: 0\nAvg. Fish Value: 0"
})

-- OPTIMIZATION LEVEL SETTINGS - COMPLETELY REWRITTEN TO ACTUALLY REDUCE LAG
smartRight:AddDropdown({
    Name = "Optimization Level",
    Values = {"Off", "Light", "Balanced", "Heavy"},
    Default = "Balanced",
    Flag = "optimization_level",
    Callback = function(level)
        getgenv().OptimizationLevel = level
    end
})

-- Apply Optimization Button - Fixed to actually reduce lag
smartRight:AddButton({
    Name = "Apply Optimization",
    Callback = function()
        local level = getgenv().OptimizationLevel or "Balanced"
        
        if level == "Off" then
            -- Restore original settings
            if getgenv().OriginalLightingSettings then
                local original = getgenv().OriginalLightingSettings
                game.Lighting.GlobalShadows = original.GlobalShadows
                game.Lighting.FogEnd = original.FogEnd
                game.Lighting.ShadowSoftness = original.ShadowSoftness
                game.Lighting.Brightness = original.Brightness
                game.Lighting.Ambient = original.Ambient
                game.Lighting.OutdoorAmbient = original.OutdoorAmbient
                game.Lighting.ExposureCompensation = original.ExposureCompensation
            end
            
            -- Re-enable particle effects safely
            for _, obj in ipairs(workspace:GetDescendants()) do
                if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Smoke") or obj:IsA("Fire") then
                    if not obj.Name:match("Essential") and not obj.Name:match("Critical") then
                        obj.Enabled = true
                    end
                end
            end
            
            Window:AddNotification({
                Title = "Optimization",
                Content = "Optimization disabled. Restored original settings.",
                Duration = 3
            })
            return
        end
        
        -- Save original lighting settings if not already saved
        if not getgenv().OriginalLightingSettings then
            getgenv().OriginalLightingSettings = {
                GlobalShadows = game.Lighting.GlobalShadows,
                FogEnd = game.Lighting.FogEnd,
                ShadowSoftness = game.Lighting.ShadowSoftness,
                Brightness = game.Lighting.Brightness,
                Ambient = game.Lighting.Ambient,
                OutdoorAmbient = game.Lighting.OutdoorAmbient,
                ExposureCompensation = game.Lighting.ExposureCompensation
            }
        end
        
        -- Apply optimization based on level
        if level == "Light" then
            -- Minimal optimization for low-end devices
            game.Lighting.GlobalShadows = false
            game.Lighting.FogEnd = 1000
            game.Lighting.ShadowSoftness = 0.5
            game.Lighting.Brightness = 0.9
            game.Lighting.Ambient = Color3.new(0.2, 0.2, 0.2)
            game.Lighting.OutdoorAmbient = Color3.new(0.3, 0.3, 0.3)
            game.Lighting.ExposureCompensation = 0
            
        elseif level == "Balanced" then
            -- Balanced optimization for medium-end devices
            game.Lighting.GlobalShadows = false
            game.Lighting.FogEnd = 500
            game.Lighting.ShadowSoftness = 0
            game.Lighting.Brightness = 0.8
            game.Lighting.Ambient = Color3.new(0.1, 0.1, 0.1)
            game.Lighting.OutdoorAmbient = Color3.new(0.2, 0.2, 0.2)
            game.Lighting.ExposureCompensation = -0.1
            
        elseif level == "Heavy" then
            -- Maximum optimization for very low-end devices
            game.Lighting.GlobalShadows = false
            game.Lighting.FogEnd = 200
            game.Lighting.ShadowSoftness = 0
            game.Lighting.Brightness = 0.6
            game.Lighting.Ambient = Color3.new(0, 0, 0)
            game.Lighting.OutdoorAmbient = Color3.new(0.1, 0.1, 0.1)
            game.Lighting.ExposureCompensation = -0.2
        end
        
        -- Disable non-essential visual effects - SAFELY
        local disabledCount = 0
        for _, obj in ipairs(workspace:GetDescendants()) do
            if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Smoke") or obj:IsA("Fire") then
                -- Only disable non-essential particles
                if not obj.Name:match("Essential") and not obj.Name:match("Critical") and not obj.Name:match("Important") and not obj.Name:match("Weather") then
                    obj.Enabled = false
                    disabledCount = disabledCount + 1
                end
            end
        end
        
        -- Notify user of successful optimization
        Window:AddNotification({
            Title = "Optimization",
            Content = string.format("%s optimization applied! Disabled %d non-essential effects.", level, disabledCount),
            Duration = 3
        })
    end
})

-- Automation Tab Sections (Simplified)
local autoLeft = Auto:DrawSection({
    Name = "Quests",
    Position = "left"
})

-- Deep Sea Quest Automation
autoLeft:AddToggle({
    Name = "Deep Sea Quest Automation",
    Default = false,
    Flag = "deep_sea_quest_auto",
    Callback = function(state)
        getgenv().DeepSeaQuestAuto = state
        if state then
            task.spawn(function()
                while getgenv().DeepSeaQuestAuto do
                    pcall(function()
                        local board = workspace:FindFirstChild("!!! MENU RINGS")
                        if board then
                            board = board:FindFirstChild("Deep Sea Tracker")
                            if board then
                                board = board:FindFirstChild("Board")
                                if board then
                                    local label = board:FindFirstChild("Gui")
                                    if label then
                                        label = label:FindFirstChild("Content")
                                        if label then
                                            label = label:FindFirstChild("Label1")
                                            if label then
                                                local text = label.Text
                                                local percent = tonumber(text:match("(%d+)%%"))
                                                
                                                if percent and percent < 100 then
                                                    local posNotComplete = CFrame.new(-3563.65063, -279.074219, -1605.75671)
                                                    local player = game.Players.LocalPlayer
                                                    local char = player.Character
                                                    if char and char:FindFirstChild("HumanoidRootPart") then
                                                        char.HumanoidRootPart.CFrame = posNotComplete
                                                    end
                                                elseif percent and percent >= 100 then
                                                    local posComplete = CFrame.new(-3698.01001, -135.073914, -1010.34033)
                                                    local player = game.Players.LocalPlayer
                                                    local char = player.Character
                                                    if char and char:FindFirstChild("HumanoidRootPart") then
                                                        char.HumanoidRootPart.CFrame = posComplete
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end)
                    task.wait(5)
                end
            end)
        end
    end
})

-- Shop Tab Sections (Simplified)
local shopLeft = Shop:DrawSection({
    Name = "Equipment",
    Position = "left"
})

-- Rod Purchase System
shopLeft:AddDropdown({
    Name = "Premium Fishing Rods",
    Values = {
        "Starter Rod - Free",
        "Luck Rod - 250 coins",
        "Carbon Rod - 900 coins",
        "Grass Rod - 1.5k coins",
        "Demascus Rod - 3k coins",
        "Ice Rod - 5k coins",
        "Midnight Rod - 50k coins",
        "Fluorescent Rod - 715k coins",
        "Astral Rod - 1M coins",
        "Hazmat Rod - 1.3M coins",
        "Ares Rod - 3M coins",
        "Angler Rod - 8M coins"
    },
    Default = "Starter Rod - Free",
    Flag = "selected_rod",
    Callback = function(value)
        getgenv().SelectedRod = value
    end
})

shopLeft:AddButton({
    Name = "Purchase Selected Rod",
    Callback = function()
        pcall(function()
            local rodMap = {
                ["Starter Rod - Free"] = 1,
                ["Luck Rod - 250 coins"] = 4,
                ["Carbon Rod - 900 coins"] = 76,
                ["Grass Rod - 1.5k coins"] = 85,
                ["Demascus Rod - 3k coins"] = 77,
                ["Ice Rod - 5k coins"] = 78,
                ["Midnight Rod - 50k coins"] = 80,
                ["Fluorescent Rod - 715k coins"] = 5,
                ["Astral Rod - 1M coins"] = 6,
                ["Hazmat Rod - 1.3M coins"] = 7,
                ["Ares Rod - 3M coins"] = 9,
                ["Angler Rod - 8M coins"] = 10
            }
            
            local rodName = getgenv().SelectedRod or "Starter Rod - Free"
            local rodId = rodMap[rodName]
            
            if rodId then
                purchaseRod(rodId)
                Window:AddNotification({
                    Title = "Success",
                    Content = "Rod purchased successfully!",
                    Duration = 3
                })
            end
        end)
    end
})

-- Initialize global variables
getgenv().AdvancedFishing = false
getgenv().AutoSellItems = false
getgenv().SmartFarmEnabled = false
getgenv().DeepSeaQuestAuto = false
getgenv().CurrentRodId = 1
getgenv().CurrentBaitId = 10
getgenv().SelectedRod = "Starter Rod - Free"
getgenv().SellInterval = 3
getgenv().OptimizationLevel = "Balanced"

-- Config Manager
local Configs = Window:DrawConfig({
    Name = "Configuration",
    Icon = "folder",
    Config = FileWatcher
})

Configs:Init()

-- Status Tracking with Performance Monitoring
local function updateStatus()
    pcall(function()
        local statusSection = Home:DrawSection({
            Name = "System Status",
            Position = "left"
        })
        
        local RunService = game:GetService("RunService")
        local Stats = game:GetService("Stats")
        
        local fps = 0
        local ping = 0
        local timePlayed = 0
        local joinTime = os.time()
        
        RunService.Heartbeat:Connect(function()
            fps = math.floor(1 / RunService.Heartbeat:Wait())
            ping = Stats.Network.ServerStatsItem["Data Ping"]:GetValue()
            timePlayed = os.time() - joinTime
            
            local hours = math.floor(timePlayed / 3600)
            local minutes = math.floor((timePlayed % 3600) / 60)
            local seconds = timePlayed % 60
            
            local timeFormatted = string.format("%02d:%02d:%02d", hours, minutes, seconds)
            
            statusSection:AddParagraph({
                Title = "Performance Monitor",
                Content = "FPS: " .. fps .. "\nPing: " .. math.floor(ping) .. " ms\nTime: " .. timeFormatted
            })
        end)
    end)
end

task.spawn(updateStatus)

Window:AddNotification({
    Title = "Loaded",
    Content = "Souls Hub Pro v2.1.0 loaded successfully!\nLag reduction fixed and Smart Farm system activated!",
    Duration = 6
})

Window:Draw()
