-- =====================================================
-- ULTIMATE SOULS HUB TSB - THE STRONGEST BATTLEGROUNDS
-- =====================================================
-- Created by: MiniMax Agent
-- Version: Ultimate Edition
-- Game: The Strongest Battlegrounds
-- Features: All-in-one hub with movesets, ESP, Combat, and more

local SoulsHub = loadstring(game:HttpGet("https://pandadevelopment.net/virtual/file/e7f388d3c065df7a"))()

task.wait(1)

SoulsHub:Loader(nil, 1).yield()

local FileWatcher = SoulsHub:ConfigManager({
	Directory = "UltimateSoulsHub",
	Config = "Ultimate-Configs"	
});

local Window = SoulsHub.new({
	Keybind = "LeftAlt",
});

local watermark = Window:Watermark();

watermark:AddText({
	Icon = "user",
	Text = "Ultimate Souls Hub"
})

local vim = watermark:AddText({
	Icon = "clock",
	Text = SoulsHub:GetTimeNow()
})

task.spawn(function()
	while true do task.wait()
		vim:SetText(SoulsHub:GetTimeNow())
		Window.Username = "Ultimate Player"
	end;
end)

Window:Update({
	ExpireDate = SoulsHub:GetDate(tick() + 84000)
})

watermark:AddText({
	Icon = "server",
	Text = "TSB Ultimate"
})

-- =====================================================
-- CATEGORY AND TAB STRUCTURE
-- =====================================================

Window:DrawCategory({
	Name = "Combat & Movesets"
})

local Combat = Window:DrawTab({
	Icon = "sword",
	Name = "Combat & Movesets",
	Type = "Double"
});

Window:DrawCategory({
	Name = "Visual & ESP"
})

local Visuals = Window:DrawTab({
	Icon = "eye",
	Name = "Visual & ESP"
});

local VisualsContainer = Window:DrawContainerTab({
	Icon = "eye",
	Name = "Visual Options"
});

local ESPTab = VisualsContainer:DrawTab({
	Icon = "eye",
	Name = "ESP & Highlight"
})

local AuraTab = VisualsContainer:DrawTab({
	Icon = "sparkles",
	Name = "Aura & Effects"
})

Window:DrawCategory({
	Name = "Player Enhancement"
})

local Player = Window:DrawTab({
	Icon = "user",
	Name = "Player Enhancement"
});

Window:DrawCategory({
	Name = "Utility & Tools"
})

local Utility = Window:DrawTab({
	Icon = "tool",
	Name = "Utility & Tools"
});

local UtilityContainer = Window:DrawContainerTab({
	Icon = "tool",
	Name = "Utilities"
});

local ServerTab = UtilityContainer:DrawTab({
	Icon = "server",
	Name = "Server Tools"
})

local AdminTab = UtilityContainer:DrawTab({
	Icon = "shield",
	Name = "Admin Commands"
})

Window:DrawCategory({
	Name = "Configuration"
})

local Configs = Window:DrawTab({
	Name = "Configs",
	Icon = "folder",
	Type = 'Single'
});

local General = Window:DrawTab({
	Name = "General Settings",
	Icon = "settings-3",
	Type = 'Single'
});

Configs:Init();

-- =====================================================
-- COMBAT & MOVESETS TAB
-- =====================================================

-- Garou Moveset Section
do
	local garouSection = Combat:DrawSection({
		Name = "Garou Moveset",
		Position = 'LEFT'
	});
	
	-- Garou Basic Moves
	garouSection:AddButton({
		Name = "Ravage (Player)",
		Callback = function()
			local player = game.Players.LocalPlayer
			repeat wait() until player.Character.Humanoid
			local humanoid = player.Character.Humanoid
			
			player.Character.Humanoid.WalkSpeed = 0
			local anim = Instance.new("Animation")
			anim.AnimationId = "rbxassetid://16945573694"
			local playAnim = humanoid:LoadAnimation(anim)
			anim.AnimationId = "rbxassetid://0"
			playAnim:Play()
			
			wait(0.7)
			local anim2 = Instance.new("Animation")
			anim2.AnimationId = "rbxassetid://16945550029"
			local playAnim2 = humanoid:LoadAnimation(anim2)
			anim2.AnimationId = "rbxassetid://0"
			playAnim2:Play()
			
			local soundeffect = Instance.new("Sound")
			soundeffect.SoundId = "rbxassetid://17325540665"
			soundeffect.Parent = game.Players.LocalPlayer.Character.Torso
			soundeffect:Play()
			soundeffect.Volume = 1
			
			wait(1.3)
			player.Character.Humanoid.WalkSpeed = 16
		end,
	})
	
	garouSection:AddButton({
		Name = "Swift Sweep",
		Callback = function()
			local player = game.Players.LocalPlayer
			repeat wait() until player.Character.Humanoid
			local humanoid = player.Character.Humanoid
			
			player.Character.Humanoid.WalkSpeed = 10
			local anim2 = Instance.new("Animation")
			anim2.AnimationId = "rbxassetid://16944345619"
			local playAnim2 = humanoid:LoadAnimation(anim2)
			anim2.AnimationId = "rbxassetid://0"
			playAnim2:Play()
			wait(1)
			player.Character.Humanoid.WalkSpeed = 16
		end,
	})
	
	garouSection:AddButton({
		Name = "Collateral Ruin",
		Callback = function()
			local player = game.Players.LocalPlayer
			repeat wait() until player.Character.Humanoid
			local humanoid = player.Character.Humanoid
			
			player.Character.Humanoid.WalkSpeed = 0
			local anim2 = Instance.new("Animation")
			anim2.AnimationId = "rbxassetid://17325254223"
			local playAnim2 = humanoid:LoadAnimation(anim2)
			wait(0.1)
			anim2.AnimationId = "rbxassetid://0"
			playAnim2:Play()
			wait(1.2)
			player.Character.Humanoid.WalkSpeed = 16
		end,
	})
	
	-- Garou Ultimate Moves
	garouSection:AddButton({
		Name = "KJ Ultimate 1",
		Callback = function()
			local player = game.Players.LocalPlayer
			repeat wait() until player.Character.Humanoid
			local humanoid = player.Character.Humanoid
			
			player.Character.Humanoid.WalkSpeed = 0
			local anim = Instance.new("Animation")
			anim.AnimationId = "rbxassetid://17140902079"
			local playAnim = humanoid:LoadAnimation(anim)
			anim.AnimationId = "rbxassetid://0"
			playAnim:Play()
			wait(8.2)
			player.Character.Humanoid.WalkSpeed = 16
		end,
	})
	
	garouSection:AddButton({
		Name = "KJ Ultimate 2",
		Callback = function()
			local player = game.Players.LocalPlayer
			repeat wait() until player.Character.Humanoid
			local humanoid = player.Character.Humanoid
			
			player.Character.Humanoid.WalkSpeed = 0
			local anim = Instance.new("Animation")
			anim.AnimationId = "rbxassetid://18462892217"
			local playAnim = humanoid:LoadAnimation(anim)
			anim.AnimationId = "rbxassetid://0"
			playAnim:Play()
			wait(8)
			player.Character.Humanoid.WalkSpeed = 16
		end,
	})
end

-- Gojo Moveset Section
do
	local gojoSection = Combat:DrawSection({
		Name = "Gojo Moveset",
		Position = 'RIGHT'
	});
	
	gojoSection:AddButton({
		Name = "Blue (Attract/Lapse)",
		Callback = function()
			local player = game.Players.LocalPlayer
			repeat wait() until player.Character.Humanoid
			local humanoid = player.Character.Humanoid
			
			local anim = Instance.new("Animation")
			anim.AnimationId = "rbxassetid://15121659862"
			local playAnim = humanoid:LoadAnimation(anim)
			playAnim:Play()
		end,
	})
	
	gojoSection:AddButton({
		Name = "Red (Repel)",
		Callback = function()
			local player = game.Players.LocalPlayer
			repeat wait() until player.Character.Humanoid
			local humanoid = player.Character.Humanoid
			
			local anim = Instance.new("Animation")
			anim.AnimationId = "rbxassetid://15125307874"
			local playAnim = humanoid:LoadAnimation(anim)
			playAnim:Play()
		end,
	})
	
	gojoSection:AddButton({
		Name = "Hollow Purple",
		Callback = function()
			local player = game.Players.LocalPlayer
			repeat wait() until player.Character.Humanoid
			local humanoid = player.Character.Humanoid
			
			local anim = Instance.new("Animation")
			anim.AnimationId = "rbxassetid://15041166062"
			local playAnim = humanoid:LoadAnimation(anim)
			playAnim:Play()
		end,
	})
	
	gojoSection:AddButton({
		Name = "Infinity (Ultimate)",
		Callback = function()
			local player = game.Players.LocalPlayer
			repeat wait() until player.Character.Humanoid
			local humanoid = player.Character.Humanoid
			
			local anim = Instance.new("Animation")
			anim.AnimationId = "rbxassetid://13643152947"
			local playAnim = humanoid:LoadAnimation(anim)
			playAnim:Play()
		end,
	})
end

-- =====================================================
-- VISUAL & ESP TAB
-- =====================================================

do
	local espSection = ESPTab:DrawSection({
		Name = "ESP Settings",
		Position = 'LEFT'
	});
	
	-- ESP Toggles
	local espEnabled = espSection:AddToggle({
		Name = "Enable ESP",
		Flag = "esp_enabled",
		Default = false,
		Callback = function(enabled)
			_G.FeatureStates.ESP_Enabled = enabled
			if enabled then
				task.spawn(function()
					while _G.FeatureStates.ESP_Enabled do
						task.wait()
						drawESP()
					end
					clearESP()
				end)
			else
				clearESP()
			end
		end
	});
	
	espEnabled.Link:AddOption():AddColorPicker({
		Name = "Box ESP Color",
		Default = Color3.fromRGB(255, 0, 0),
		Flag = "esp_box_color",
		Callback = function(color)
			_G.FeatureStates.esp_box_color = color
		end
	});
	
	espEnabled.Link:AddOption():AddColorPicker({
		Name = "Name ESP Color",
		Default = Color3.fromRGB(0, 255, 0),
		Flag = "esp_name_color",
		Callback = function(color)
			_G.FeatureStates.esp_name_color = color
		end
	});
	
	espSection:AddToggle({
		Name = "Show Names",
		Flag = "esp_show_names",
		Default = true,
		Callback = function(enabled)
			_G.FeatureStates.esp_show_names = enabled
		end
	});
	
	espSection:AddToggle({
		Name = "Show Boxes",
		Flag = "esp_show_boxes",
		Default = true,
		Callback = function(enabled)
			_G.FeatureStates.esp_show_boxes = enabled
		end
	});
	
	espSection:AddToggle({
		Name = "Show Health",
		Flag = "esp_show_health",
		Default = true,
		Callback = function(enabled)
			_G.FeatureStates.esp_show_health = enabled
		end
	});
	
	espSection:AddToggle({
		Name = "Show Tracers",
		Flag = "esp_show_tracers",
		Default = false,
		Callback = function(enabled)
			_G.FeatureStates.esp_show_tracers = enabled
		end
	});
end

-- =====================================================
-- AURA & EFFECTS TAB
-- =====================================================

do
	local auraSection = AuraTab:DrawSection({
		Name = "Aura Effects",
		Position = 'LEFT'
	});
	
	local auraEnabled = auraSection:AddToggle({
		Name = "Enable Aura",
		Flag = "aura_enabled",
		Default = false,
		Callback = function(enabled)
			_G.FeatureStates.AuraEnabled = enabled
			if enabled then
				startAura()
			else
				stopAura()
			end
		end
	});
	
	auraEnabled.Link:AddOption():AddColorPicker({
		Name = "Aura Color",
		Default = Color3.fromRGB(0, 255, 255),
		Flag = "aura_color",
		Callback = function(color)
			_G.FeatureStates.AuraColor = color
		end
	});
	
	auraEnabled.Link:AddOption():AddSlider({
		Name = "Aura Size",
		Min = 1,
		Max = 10,
		Round = 0,
		Default = 3,
		Type = "studs",
		Flag = "aura_size",
		Callback = function(size)
			_G.FeatureStates.AuraSize = size
		end
	});
	
	local effectSection = AuraTab:DrawSection({
		Name = "Visual Effects",
		Position = 'RIGHT'
	});
	
	effectSection:AddToggle({
		Name = "Highlight Dummy",
		Flag = "highlight_dummy",
		Default = false,
		Callback = function(enabled)
			if enabled then
				enableDummyHighlight()
			else
				disableDummyHighlight()
			end
		end
	});
	
	effectSection:AddToggle({
		Name = "Camera Follow",
		Flag = "camera_follow",
		Default = false,
		Callback = function(enabled)
			if enabled then
				enableCameraFollow()
			else
				disableCameraFollow()
			end
		end
	});
end

-- =====================================================
-- PLAYER ENHANCEMENT TAB
-- =====================================================

do
	local movementSection = Player:DrawSection({
		Name = "Movement",
		Position = 'LEFT'
	});
	
	movementSection:AddSlider({
		Name = "WalkSpeed",
		Min = 16,
		Max = 200,
		Round = 0,
		Default = 16,
		Type = "studs/s",
		Callback = function(value)
			local player = game.Players.LocalPlayer
			if player and player.Character and player.Character:FindFirstChildOfClass("Humanoid") then
				player.Character.Humanoid.WalkSpeed = value
			end
		end
	});
	
	movementSection:AddSlider({
		Name = "JumpPower",
		Min = 50,
		Max = 300,
		Round = 0,
		Default = 50,
		Type = "studs",
		Callback = function(value)
			local player = game.Players.LocalPlayer
			if player and player.Character and player.Character:FindFirstChildOfClass("Humanoid") then
				player.Character.Humanoid.JumpPower = value
			end
		end
	});
	
	movementSection:AddToggle({
		Name = "NoClip",
		Flag = "noclip_enabled",
		Default = false,
		Callback = function(enabled)
			if enabled then
				enableNoClip()
			else
				disableNoClip()
			end
		end
	});
	
	local combatSection = Player:DrawSection({
		Name = "Combat Enhancement",
		Position = 'RIGHT'
	});
	
	combatSection:AddToggle({
		Name = "Auto Block",
		Flag = "auto_block",
		Default = false,
		Callback = function(enabled)
			if enabled then
				enableAutoBlock()
			else
				disableAutoBlock()
			end
		end
	});
	
	combatSection:AddToggle({
		Name = "M1 Reach",
		Flag = "m1_reach",
		Default = false,
		Callback = function(enabled)
			if enabled then
				enableM1Reach()
			else
				disableM1Reach()
			end
		end
	});
	
	combatSection:AddToggle({
		Name = "Anti Stun",
		Flag = "anti_stun",
		Default = false,
		Callback = function(enabled)
			if enabled then
				enableAntiStun()
			else
				disableAntiStun()
			end
		end
	});
	
	combatSection:AddToggle({
		Name = "No Slow",
		Flag = "no_slow",
		Default = false,
		Callback = function(enabled)
			if enabled then
				enableNoSlow()
			else
				disableNoSlow()
			end
		end
	});
end

-- =====================================================
-- SERVER TOOLS TAB
-- =====================================================

do
	local serverSection = ServerTab:DrawSection({
		Name = "Server Management",
		Position = 'LEFT'
	});
	
	serverSection:AddButton({
		Name = "Rejoin Server",
		Callback = function()
			local TeleportService = game:GetService("TeleportService")
			local player = game.Players.LocalPlayer
			
			local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
			local label = Instance.new("TextLabel", screenGui)
			label.Size = UDim2.new(0.3, 0, 0.2, 0)
			label.Position = UDim2.new(0.35, 0, 0.4, 0)
			label.TextScaled = true
			label.BackgroundTransparency = 1
			label.TextColor3 = Color3.new(1, 1, 1)
			label.Font = Enum.Font.GothamBold
			
			for i = 5, 1, -1 do
				label.Text = "Rejoining in " .. i .. "..."
				task.wait(1)
			end
			
			screenGui:Destroy()
			TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, player)
		end
	});
	
	serverSection:AddButton({
		Name = "Server Hop",
		Callback = function()
			local TeleportService = game:GetService("TeleportService")
			local HttpService = game:GetService("HttpService")
			local player = game.Players.LocalPlayer
			local placeId = game.PlaceId
			
			local function getRandomServer()
				local servers = {}
				local success, response = pcall(function()
					return HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..placeId.."/servers/Public?sortOrder=Asc&limit=100"))
				end)
				
				if success and response and response.data then
					for _, server in pairs(response.data) do
						if server.playing < server.maxPlayers and server.id ~= game.JobId then
							table.insert(servers, server.id)
						end
					end
				end
				
				return #servers > 0 and servers[math.random(1, #servers)] or nil
			end
			
			local target = getRandomServer()
			if target then
				TeleportService:TeleportToPlaceInstance(placeId, target, player)
			else
				warn("No servers found.")
			end
		end
	});
	
	serverSection:AddButton({
		Name = "Small Server Hop",
		Callback = function()
			local TeleportService = game:GetService("TeleportService")
			local HttpService = game:GetService("HttpService")
			local player = game.Players.LocalPlayer
			local placeId = game.PlaceId
			
			local function getSmallServer()
				local servers = {}
				local cursor = nil
				
				for _ = 1, 5 do
					local url = "https://games.roblox.com/v1/games/"..placeId.."/servers/Public?sortOrder=Asc&limit=100"
					if cursor then url = url.."&cursor="..cursor end
					
					local success, response = pcall(function()
						return HttpService:JSONDecode(game:HttpGet(url))
					end)
					
					if success and response and response.data then
						for _, server in ipairs(response.data) do
							if server.playing < 5 and server.id ~= game.JobId then
								table.insert(servers, server.id)
							end
						end
						if response.nextPageCursor then
							cursor = response.nextPageCursor
						else
							break
						end
					else
						break
					end
				end
				
				return #servers > 0 and servers[math.random(1, #servers)] or nil
			end
			
			local target = getSmallServer()
			if target then
				TeleportService:TeleportToPlaceInstance(placeId, target, player)
			else
				warn("No small servers found.")
			end
		end
	});
end

-- =====================================================
-- ADMIN COMMANDS TAB
-- =====================================================

do
	local adminSection = AdminTab:DrawSection({
		Name = "Admin Tools",
		Position = 'LEFT'
	});
	
	adminSection:AddButton({
		Name = "Infinite Yield",
		Callback = function()
			loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))()
		end
	});
	
	adminSection:AddButton({
		Name = "Nameless Admin",
		Callback = function()
			loadstring(game:HttpGet("https://raw.githubusercontent.com/FilteringEnabled/NamelessAdmin/main/Source"))()
		end
	});
	
	adminSection:AddButton({
		Name = "Keyboard (Mobile)",
		Callback = function()
			loadstring(game:HttpGet("https://raw.githubusercontent.com/AZYsGithub/Delta-Scripts/refs/heads/main/MobileKeyboard.txt"))()
		end
	});
end

-- =====================================================
-- GENERAL SETTINGS TAB
-- =====================================================

do
	local main = General:DrawSection({
		Name = "UI Settings"
	});
	
	local ml = main:AddColorPicker({
		Name = 'Highlight',
		Default = SoulsHub.Colors.Highlight,
		Flag = "hntbdhg43",
		Callback = function(v)
			SoulsHub:ChangeHighlightColor(v)
		end,
	}).Link:AddOption();
	
	ml:AddToggle({
		Name = "Rainbow",
		Flag = "vdsfg34w33434",
		Default = false,
		Callback = function(v)
			_G.RAINBOW = v
		end,
	})
	
	main:AddToggle({
		Name = "Always Show Tab",
		Default = Window.AlwayShowTab,
		Flag = "jyrtuj65467",
		Callback = function(v)
			Window.AlwayShowTab = v;
		end,
	})
	
	ml:AddSlider({
		Name = "Speed",
		Min = 0.01,
		Max = 1,
		Round = 2,
		Default = 0.1,
		Flag = "hngrh13241",
		Callback = function(v)
			_G.RAINBOW_SPEED = v;
		end,
	})
	
	main:AddButton({
		Name = "Print Current Config",
		Callback = function()
			print("Current Config:")
			print(SoulsHub:GetConfig())
		end
	});
end

-- =====================================================
-- IMPLEMENTATION FUNCTIONS
-- =====================================================

-- Global feature states
_G.FeatureStates = _G.FeatureStates or {}
_G.RAINBOW = _G.RAINBOW or false
_G.RAINBOW_SPEED = _G.RAINBOW_SPEED or 0.1

-- ESP Implementation
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

local espVisuals = {}

function createBoxESP(character, color)
	local box = Instance.new("BoxHandleAdornment")
	box.Adornee = character
	box.Color3 = color
	box.Transparency = 0.5
	box.AlwaysOnTop = true
	box.ZIndex = 1
	box.Extents = character.PrimaryPart.Size
	box.CFrame = character.PrimaryPart.CFrame
	box.Parent = Workspace.CurrentCamera
	return box
end

function createNameESP(character, name, color)
	local billboardGui = Instance.new("BillboardGui")
	billboardGui.Size = UDim2.new(0, 100, 0, 20)
	billboardGui.Adornee = character.PrimaryPart
	billboardGui.AlwaysOnTop = true
	billboardGui.ExtentsOffset = Vector3.new(0, character.PrimaryPart.Size.Y / 2 + 1, 0)
	
	local textLabel = Instance.new("TextLabel")
	textLabel.Size = UDim2.new(1, 0, 1, 0)
	textLabel.BackgroundTransparency = 1
	textLabel.TextScaled = true
	textLabel.TextColor3 = color
	textLabel.TextStrokeTransparency = 0
	textLabel.Font = Enum.Font.SourceSansBold
	textLabel.Text = name
	textLabel.Parent = billboardGui
	
	billboardGui.Parent = Workspace.CurrentCamera
	return billboardGui
end

function createHealthESP(character, health, maxHealth, color)
	local billboardGui = Instance.new("BillboardGui")
	billboardGui.Size = UDim2.new(0, 100, 0, 10)
	billboardGui.Adornee = character.PrimaryPart
	billboardGui.AlwaysOnTop = true
	billboardGui.ExtentsOffset = Vector3.new(0, character.PrimaryPart.Size.Y / 2 + 2, 0)
	
	local healthBar = Instance.new("Frame")
	healthBar.Size = UDim2.new(1, 0, 1, 0)
	healthBar.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
	healthBar.Parent = billboardGui
	
	local currentHealth = Instance.new("Frame")
	currentHealth.Size = UDim2.new(health / maxHealth, 0, 1, 0)
	currentHealth.BackgroundColor3 = color
	currentHealth.Parent = healthBar
	
	billboardGui.Parent = Workspace.CurrentCamera
	return billboardGui
end

function drawESP()
	for _, visual in pairs(espVisuals) do
		visual:Destroy()
	end
	espVisuals = {}
	
	local espBoxColor = _G.FeatureStates.esp_box_color or Color3.fromRGB(255, 0, 0)
	local espNameColor = _G.FeatureStates.esp_name_color or Color3.fromRGB(0, 255, 0)
	
	for _, player in ipairs(Players:GetPlayers()) do
		if player ~= Players.LocalPlayer and player.Character and player.Character:FindFirstChildOfClass("Humanoid") and player.Character:FindFirstChild("HumanoidRootPart") then
			local character = player.Character
			local humanoid = character:FindFirstChildOfClass("Humanoid")
			
			if _G.FeatureStates.esp_show_boxes then
				table.insert(espVisuals, createBoxESP(character, espBoxColor))
			end
			if _G.FeatureStates.esp_show_names then
				table.insert(espVisuals, createNameESP(character, player.Name, espNameColor))
			end
			if _G.FeatureStates.esp_show_health and humanoid then
				table.insert(espVisuals, createHealthESP(character, humanoid.Health, humanoid.MaxHealth, espNameColor))
			end
		end
	end
end

function clearESP()
	for _, visual in pairs(espVisuals) do
		visual:Destroy()
	end
	espVisuals = {}
end

-- Aura Implementation
local auraConnections = {}

function startAura()
	if _G.FeatureStates.AuraEnabled then
		stopAura()
		
		local player = Players.LocalPlayer
		if player and player.Character then
			local character = player.Character
			local humanoid = character:FindFirstChildOfClass("Humanoid")
			
			if humanoid then
				local connection = RunService.Heartbeat:Connect(function()
					if player.Character ~= character then
						stopAura()
						return
					end
					
					-- Create aura effect around player
					local auraSize = _G.FeatureStates.AuraSize or 3
					local auraColor = _G.FeatureStates.AuraColor or Color3.fromRGB(0, 255, 255)
					
					-- Simple aura effect (you can enhance this)
					if character:FindFirstChild("HumanoidRootPart") then
						local hrp = character.HumanoidRootPart
						-- Add your aura effect code here
					end
				end)
				
				table.insert(auraConnections, connection)
			end
		end
	end
end

function stopAura()
	for _, connection in pairs(auraConnections) do
		if typeof(connection) == "RBXScriptConnection" and connection.Connected then
			connection:Disconnect()
		end
	end
	auraConnections = {}
end

-- Dummy Highlight Implementation
function enableDummyHighlight()
	if not workspace:FindFirstChild("Live") then return end
	
	for _, npc in pairs(workspace.Live:GetChildren()) do
		if npc:IsA("Model") and npc.Name == "Weakest Dummy" then
			if not npc:FindFirstChild("_HighlightDummyTag") then
				local h = Instance.new("Highlight")
				h.Name = "_HighlightDummyTag"
				h.Adornee = npc
				h.FillTransparency = 1
				h.OutlineColor = Color3.fromRGB(170, 0, 255)
				h.OutlineTransparency = 0
				h.Parent = npc
			end
		end
	end
end

function disableDummyHighlight()
	if workspace:FindFirstChild("Live") then
		for _, npc in pairs(workspace.Live:GetChildren()) do
			if npc:IsA("Model") and npc.Name == "Weakest Dummy" then
				local h = npc:FindFirstChild("_HighlightDummyTag")
				if h then
					h:Destroy()
				end
			end
		end
	end
end

-- Camera Follow Implementation
local cameraFollowConnection

function enableCameraFollow()
	local player = Players.LocalPlayer
	local char = player.Character or player.CharacterAdded:Wait()
	local hum = char:WaitForChild("Humanoid")
	local RootPart = char:WaitForChild("HumanoidRootPart")
	
	hum.Died:Connect(function()
		char = player.Character or player.CharacterAdded:Wait()
		hum = char:WaitForChild("Humanoid")
		RootPart = char:WaitForChild("HumanoidRootPart")
	end)
	
	cameraFollowConnection = RunService:BindToRenderStep("FollowHead", Enum.RenderPriority.Camera.Value + 1, function(DeltaTime)
		if not char or (hum:GetState() == Enum.HumanoidStateType.Dead) then
			return
		end
		
		local Head = char:WaitForChild("Head")
		local ObjectSpace = RootPart.CFrame:ToObjectSpace(Head.CFrame)
		hum.CameraOffset = hum.CameraOffset:Lerp(ObjectSpace.Position - Vector3.new(0, 1.5, 0), DeltaTime * 10)
	end)
end

function disableCameraFollow()
	if cameraFollowConnection then
		cameraFollowConnection:Disconnect()
		cameraFollowConnection = nil
	end
end

-- NoClip Implementation
local noclipConnections = {}

function enableNoClip()
	local player = Players.LocalPlayer
	if player and player.Character then
		local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
		if humanoid then
			local connection = RunService.Stepped:Connect(function()
				if player.Character then
					for _, part in ipairs(player.Character:GetChildren()) do
						if part:IsA("BasePart") then
							part.CanCollide = false
						end
					end
				end
			end)
			table.insert(noclipConnections, connection)
		end
	end
end

function disableNoClip()
	for _, connection in pairs(noclipConnections) do
		if typeof(connection) == "RBXScriptConnection" and connection.Connected then
			connection:Disconnect()
		end
	end
	noclipConnections = {}
	
	local player = Players.LocalPlayer
	if player and player.Character then
		for _, part in ipairs(player.Character:GetChildren()) do
			if part:IsA("BasePart") then
				part.CanCollide = true
			end
		end
	end
end

-- Auto Block Implementation
local autoBlockConnection

function enableAutoBlock()
	autoBlockConnection = RunService.Heartbeat:Connect(function()
		local player = Players.LocalPlayer
		if player and player.Character then
			local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
			if humanoid and humanoid.Health > 0 then
				-- Add auto block logic here
				-- This would depend on the specific game's block mechanics
			end
		end
	end)
end

function disableAutoBlock()
	if autoBlockConnection then
		autoBlockConnection:Disconnect()
		autoBlockConnection = nil
	end
end

-- M1 Reach Implementation
local m1ReachConnection

function enableM1Reach()
	m1ReachConnection = RunService.Heartbeat:Connect(function()
		local player = Players.LocalPlayer
		if player and player.Character then
			local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
			if humanoid then
				-- Add M1 reach logic here
				-- This would depend on the specific game's attack mechanics
			end
		end
	end)
end

function disableM1Reach()
	if m1ReachConnection then
		m1ReachConnection:Disconnect()
		m1ReachConnection = nil
	end
end

-- Anti Stun Implementation
function enableAntiStun()
	_G.AntiStunLoop = RunService.RenderStepped:Connect(function()
		local player = Players.LocalPlayer
		if player and player.Character then
			if player.Character:FindFirstChild("Stunned") then
				player.Character.Stunned:Destroy()
			end
			if player.Character:FindFirstChild("Humanoid") then
				player.Character.Humanoid.PlatformStand = false
				if player.Character.Humanoid.WalkSpeed == 0 then
					player.Character.Humanoid.WalkSpeed = 16
				end
			end
		end
	end)
end

function disableAntiStun()
	if _G.AntiStunLoop then
		_G.AntiStunLoop:Disconnect()
		_G.AntiStunLoop = nil
	end
end

-- No Slow Implementation
function enableNoSlow()
	_G.NoSlowLoop = RunService.RenderStepped:Connect(function()
		local player = Players.LocalPlayer
		if player and player.Character and player.Character:FindFirstChild("Humanoid") then
			local hum = player.Character.Humanoid
			if hum.WalkSpeed < 20 then
				hum.WalkSpeed = 20
			end
			hum.PlatformStand = false
		end
	end)
end

function disableNoSlow()
	if _G.NoSlowLoop then
		_G.NoSlowLoop:Disconnect()
		_G.NoSlowLoop = nil
		local player = Players.LocalPlayer
		if player and player.Character and player.Character:FindFirstChild("Humanoid") then
			player.Character.Humanoid.WalkSpeed = 16
		end
	end
end

-- =====================================================
-- RAINBOW HIGHLIGHT EFFECT
-- =====================================================

task.spawn(function()
	local x = 0
	while true do task.wait(_G.RAINBOW_SPEED or 0.1)
		if _G.RAINBOW then
			SoulsHub:ChangeHighlightColor(Color3.fromHSV(x,1,1))
			x = x + 2/255
			if x >= 1 then
				x = 0
			end
		end
	end
end)

-- =====================================================
-- FINAL SETUP
-- =====================================================

Window:Draw()

-- Success notification
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "Ultimate Souls Hub",
    Text = "Successfully loaded! All features ready.",
    Duration = 5
})

print("Ultimate Souls Hub TSB - Loaded Successfully!")
print("Features: Combat, ESP, Aura, Player Enhancement, Server Tools, Admin Commands")
print("Use LeftAlt to toggle the UI")
