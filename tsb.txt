local SoulsHub = loadstring(game:HttpGet("https://pandadevelopment.net/virtual/file/e7f388d3c065df7a"))()

task.wait(1)

SoulsHub:Loader(nil, 1).yield()

local FileWatcher = SoulsHub:ConfigManager({
    Directory = "SoulsHub",
    Config = "TSB-Configs"    
})

local Window = SoulsHub.new({
    Keybind = "LeftAlt",
})

local watermark = Window:Watermark()

watermark:AddText({
    Icon = "user",
    Text = game.Players.LocalPlayer.Name
})

local timeText = watermark:AddText({
    Icon = "clock",
    Text = SoulsHub:GetTimeNow()
})

task.spawn(function()
    while task.wait() do
        timeText:SetText(SoulsHub:GetTimeNow())
    end
end)

Window:Update({
    ExpireDate = SoulsHub:GetDate(tick() + 86400)
})

watermark:AddText({
    Icon = "server",
    Text = game.JobId
})

_G.FeatureStates = {}

local MovementCombat = Window:DrawTab({
    Icon = "run",
    Name = "Movement & Combat"
})

local CharCustomization = Window:DrawTab({
    Icon = "user",
    Name = "Characters"
})

Window:DrawCategory({
    Name = "Visuals"
})

local ESPVisuals = Window:DrawTab({
    Icon = "eye",
    Name = "ESP & Visuals"
})

local AimProtection = Window:DrawTab({
    Icon = "crosshair",
    Name = "Aim & Protection"
})

Window:DrawCategory({
    Name = "Utilities"
})

local ServerAdmin = Window:DrawTab({
    Icon = "server",
    Name = "Server & Admin"
})

local ConfigCredits = Window:DrawTab({
    Icon = "info",
    Name = "Config & Credits"
})

-- MOVEMENT & COMBAT TAB
do
    local movementSection = MovementCombat:DrawSection({
        Name = "Movement",
        Position = "left"
    })
    
    local combatSection = MovementCombat:DrawSection({
        Name = "Combat",
        Position = "right"
    })
    
    -- WalkSpeed Slider (Fixed)
    movementSection:AddSlider({
        Name = "WalkSpeed",
        Min = 16,
        Max = 50,
        Round = 0,
        Default = 16,
        Type = "studs/s",
        Flag = "walkspeed",
        Callback = function(value)
            _G.FeatureStates.WalkSpeed = value
            local plr = game.Players.LocalPlayer
            if plr and plr.Character and plr.Character:FindFirstChildOfClass("Humanoid") then
                plr.Character.Humanoid.WalkSpeed = value
                -- Fallback if it gets reset
                task.spawn(function()
                    while _G.FeatureStates.WalkSpeed == value and plr.Character and plr.Character:FindFirstChildOfClass("Humanoid") do
                        if plr.Character.Humanoid.WalkSpeed ~= value then
                            plr.Character.Humanoid.WalkSpeed = value
                        end
                        task.wait(0.5)
                    end
                end)
            end
        end
    })
    
    -- JumpPower Slider (Fixed)
    movementSection:AddSlider({
        Name = "JumpPower",
        Min = 50,
        Max = 150,
        Round = 0,
        Default = 50,
        Type = "studs",
        Flag = "jumppower",
        Callback = function(value)
            _G.FeatureStates.JumpPower = value
            local plr = game.Players.LocalPlayer
            if plr and plr.Character and plr.Character:FindFirstChildOfClass("Humanoid") then
                plr.Character.Humanoid.JumpPower = value
                -- Fallback if it gets reset
                task.spawn(function()
                    while _G.FeatureStates.JumpPower == value and plr.Character and plr.Character:FindFirstChildOfClass("Humanoid") do
                        if plr.Character.Humanoid.JumpPower ~= value then
                            plr.Character.Humanoid.JumpPower = value
                        end
                        task.wait(0.5)
                    end
                end)
            end
        end
    })
    
    -- No Slide End Lag (Fixed)
    movementSection:AddToggle({
        Name = "No Slide End Lag",
        Flag = "no_slide_endlag",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.NoSlideEndLag = enabled
            if enabled then
                pcall(function()
                    loadstring(game:HttpGet("https://raw.githubusercontent.com/Slaphello/No-endlag-side-dash/refs/heads/main/No%20endlag%20side%20dash"))()
                end)
            end
        end
    })
    
    -- Anti Lag (Fixed)
    movementSection:AddToggle({
        Name = "Anti Lag",
        Flag = "anti_lag",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.AntiLag = enabled
            if enabled then
                pcall(function()
                    loadstring(game:HttpGet("https://raw.githubusercontent.com/Kietba/Kietba/refs/heads/main/Antilag%20script"))()
                end)
            end
        end
    })
    
    -- Fake Dash Q (Improved)
    movementSection:AddToggle({
        Name = "Fake Dash Q",
        Flag = "fake_dash_q",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.FakeDashQ = enabled
            if enabled then
                local player = game.Players.LocalPlayer
                local playerGui = player:WaitForChild("PlayerGui")
                
                -- Create custom UI button
                local screenGui = Instance.new("ScreenGui")
                screenGui.Name = "DashGui"
                screenGui.ResetOnSpawn = false
                screenGui.Parent = playerGui
                
                local dashBtn = Instance.new("TextButton")
                dashBtn.Name = "DashForward"
                dashBtn.Text = "âš¡ DASH"
                dashBtn.Size = UDim2.new(0, 0, 0, 0)
                dashBtn.Position = UDim2.new(0.5, -80, 0.5, -100)
                dashBtn.AnchorPoint = Vector2.new(0.5, 0.5)
                dashBtn.BackgroundColor3 = Color3.fromRGB(60, 40, 100)
                dashBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
                dashBtn.TextSize = 22
                dashBtn.Font = Enum.Font.GothamBold
                dashBtn.BorderSizePixel = 0
                dashBtn.BackgroundTransparency = 0.2
                dashBtn.Active = true
                dashBtn.Draggable = true
                dashBtn.AutoButtonColor = false
                dashBtn.Visible = false
                dashBtn.Parent = screenGui
                
                -- Styling
                Instance.new("UICorner", dashBtn).CornerRadius = UDim.new(0, 15)
                Instance.new("UIStroke", dashBtn).Color = Color3.fromRGB(180, 120, 255)
                
                -- Smooth appearance
                task.wait(0.3)
                dashBtn.Visible = true
                game:GetService("TweenService"):Create(dashBtn, TweenInfo.new(0.4), {
                    Size = UDim2.new(0, 180, 0, 60)
                }):Play()
                
                -- Dash logic
                local running = false
                dashBtn.MouseButton1Click:Connect(function()
                    if running then return end
                    running = true
                    
                    local char = player.Character or player.CharacterAdded:Wait()
                    local hrp = char:WaitForChild("HumanoidRootPart")
                    local humanoid = char:FindFirstChildOfClass("Humanoid")
                    local animator = humanoid:FindFirstChildOfClass("Animator") or Instance.new("Animator", humanoid)
                    
                    -- Play animation
                    local anim = Instance.new("Animation")
                    anim.AnimationId = "rbxassetid://10479335397"
                    local track = animator:LoadAnimation(anim)
                    track:Play()
                    
                    -- Dash 32 studs forward
                    local distanceToTravel = 32
                    local speed = 100
                    local distanceTraveled = 0
                    local lastPosition = hrp.Position
                    
                    local RunService = game:GetService("RunService")
                    local connection
                    connection = RunService.Heartbeat:Connect(function(dt)
                        if not hrp or not hrp.Parent then 
                            connection:Disconnect() 
                            return 
                        end
                        
                        local moveStep = hrp.CFrame.LookVector * speed * dt
                        hrp.CFrame = hrp.CFrame + moveStep
                        
                        distanceTraveled += (hrp.Position - lastPosition).Magnitude
                        lastPosition = hrp.Position
                        
                        if distanceTraveled >= distanceToTravel then
                            connection:Disconnect()
                            running = false
                        end
                    end)
                end)
                
                -- Store reference for cleanup
                _G.DashGui = screenGui
            else
                if _G.DashGui then
                    _G.DashGui:Destroy()
                    _G.DashGui = nil
                end
            end
        end
    })
    
    -- M1 Reach Rework (Fixed with loop)
    combatSection:AddToggle({
        Name = "M1 Reach Rework",
        Flag = "m1_reach_rework",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.M1ReachRework = enabled
            if enabled then
                local function startM1Loop()
                    while _G.FeatureStates.M1ReachRework and game.Players.LocalPlayer.Character do
                        pcall(function()
                            loadstring(game:HttpGet("https://raw.githubusercontent.com/Kietba/Kietba/refs/heads/main/M1%20Reach%20Rework"))()
                        end)
                        task.wait(5)
                    end
                end
                
                task.spawn(startM1Loop)
                -- Connect to character added event to restart after death
                game.Players.LocalPlayer.CharacterAdded:Connect(function()
                    if _G.FeatureStates.M1ReachRework then
                        task.wait(1)
                        task.spawn(startM1Loop)
                    end
                end)
            end
        end
    })
    
    -- Invisible Block (Improved)
    combatSection:AddToggle({
        Name = "Invisible Block",
        Flag = "invisible_block",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.InvisibleBlock = enabled
            if enabled then
                local player = game.Players.LocalPlayer
                local playerGui = player:WaitForChild("PlayerGui")
                
                -- Custom UI button
                local screenGui = Instance.new("ScreenGui")
                screenGui.Name = "BlockAnimationGui"
                screenGui.ResetOnSpawn = false
                screenGui.Parent = playerGui
                
                local button = Instance.new("TextButton")
                button.Name = "ToggleBlock"
                button.Text = "ðŸ”µ BLOCK: OFF"
                button.Size = UDim2.new(0, 250, 0, 50)
                button.Position = UDim2.new(0.5, -70, 0.5, -25)
                button.AnchorPoint = Vector2.new(0.5, 0.5)
                button.BackgroundColor3 = Color3.fromRGB(50, 30, 80)
                button.TextColor3 = Color3.fromRGB(255, 255, 255)
                button.TextSize = 20
                button.Font = Enum.Font.GothamBold
                button.BorderSizePixel = 0
                button.BackgroundTransparency = 0.2
                button.Active = true
                button.Draggable = true
                button.Parent = screenGui
                button.AutoButtonColor = false
                
                -- Styling
                Instance.new("UICorner", button).CornerRadius = UDim.new(0, 14)
                Instance.new("UIStroke", button).Color = Color3.fromRGB(130, 80, 220)
                
                -- Block animation logic
                local targetAnimationId = "rbxassetid://10470389827"
                local blockEnabled = false
                local isDragging = false
                local blockConnection = nil
                
                local function blockAnimation(humanoid)
                    for _, track in ipairs(humanoid:GetPlayingAnimationTracks()) do
                        if track.Animation and track.Animation.AnimationId == targetAnimationId then
                            track:Stop()
                            track:Destroy()
                        end
                    end
                end
                
                local function toggleBlock(state)
                    blockEnabled = state
                    button.Text = blockEnabled and "ðŸŸ¢ BLOCK: ON" or "ðŸ”µ BLOCK: OFF"
                    
                    if blockEnabled then
                        local function startBlocking()
                            local char = player.Character or player.CharacterAdded:Wait()
                            local humanoid = char:WaitForChild("Humanoid")
                            task.spawn(function()
                                while blockEnabled and humanoid and humanoid.Parent do
                                    blockAnimation(humanoid)
                                    task.wait(0.05)
                                end
                            end)
                            blockConnection = humanoid.AnimationPlayed:Connect(function(track)
                                if track.Animation and track.Animation.AnimationId == targetAnimationId then
                                    track:Stop()
                                    track:Destroy()
                                end
                            end)
                        end
                        
                        startBlocking()
                        player.CharacterAdded:Connect(function()
                            if blockEnabled then
                                task.wait(1)
                                startBlocking()
                            end
                        end)
                    else
                        if blockConnection then
                            blockConnection:Disconnect()
                            blockConnection = nil
                        end
                    end
                end
                
                -- Dragging protection
                local dragStarted = false
                button.InputBegan:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                        dragStarted = true
                    end
                end)
                
                button.InputEnded:Connect(function(input)
                    if dragStarted and (input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch) then
                        if not isDragging then
                            toggleBlock(not blockEnabled)
                        end
                        dragStarted = false
                    end
                end)
                
                button.MouseEnter:Connect(function()
                    isDragging = false
                end)
                
                button.MouseMoved:Connect(function()
                    isDragging = true
                end)
                
                button.MouseLeave:Connect(function()
                    isDragging = false
                end)
                
                -- Store reference
                _G.BlockGui = screenGui
            else
                if _G.BlockGui then
                    _G.BlockGui:Destroy()
                    _G.BlockGui = nil
                end
            end
        end
    })
    
    -- No Stun (Fixed)
    combatSection:AddToggle({
        Name = "No Stun",
        Flag = "no_stun",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.NoStun = enabled
            if enabled then
                if not _G.StunBypass then
                    _G.StunBypass = game:GetService("RunService").RenderStepped:Connect(function()
                        local char = game.Players.LocalPlayer.Character
                        if char then
                            if char:FindFirstChild("Stunned") then
                                char.Stunned:Destroy()
                            end
                            if char:FindFirstChild("Humanoid") then
                                char.Humanoid.PlatformStand = false
                                if char.Humanoid.WalkSpeed == 0 then
                                    char.Humanoid.WalkSpeed = 16
                                end
                            end
                        end
                    end)
                end
            else
                if _G.StunBypass then
                    _G.StunBypass:Disconnect()
                    _G.StunBypass = nil
                end
            end
        end
    })
    
    -- No Slowed (Fixed)
    combatSection:AddToggle({
        Name = "No Slowed",
        Flag = "no_slowed",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.NoSlowed = enabled
            if enabled then
                if not _G.NoSlowLoop then
                    _G.NoSlowLoop = game:GetService("RunService").RenderStepped:Connect(function()
                        local char = game.Players.LocalPlayer.Character
                        if char and char:FindFirstChild("Humanoid") then
                            local hum = char.Humanoid
                            if hum.WalkSpeed < 20 then
                                hum.WalkSpeed = 20
                            end
                            hum.PlatformStand = false
                        end
                    end)
                end
            else
                if _G.NoSlowLoop then
                    _G.NoSlowLoop:Disconnect()
                    _G.NoSlowLoop = nil
                end
                local char = game.Players.LocalPlayer.Character
                if char and char:FindFirstChild("Humanoid") then
                    char.Humanoid.WalkSpeed = 16
                end
            end
        end
    })
    
    -- Auto Kyoto (Fixed)
    combatSection:AddToggle({
        Name = "Auto Kyoto",
        Flag = "auto_kyoto",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.AutoKyoto = enabled
            if enabled then
                local player = game.Players.LocalPlayer
                local playerGui = player:WaitForChild("PlayerGui")
                
                -- Custom UI button
                local screenGui = Instance.new("ScreenGui")
                screenGui.Name = "KyotoGui"
                screenGui.ResetOnSpawn = false
                screenGui.Parent = playerGui
                
                -- Main button
                local button = Instance.new("TextButton")
                button.Parent = screenGui
                button.Size = UDim2.new(0, 60, 0, 60)
                button.Position = UDim2.new(0.5, -120, 0.8, 0)
                button.Text = "ðŸŽ¯"
                button.BackgroundColor3 = Color3.fromRGB(70, 40, 120)
                button.TextColor3 = Color3.new(1, 1, 1)
                button.TextSize = 28
                button.Font = Enum.Font.GothamBold
                button.Active = true
                button.Draggable = true
                button.BackgroundTransparency = 0.2
                
                -- Styling
                Instance.new("UICorner", button).CornerRadius = UDim.new(1, 0)
                Instance.new("UIStroke", button).Color = Color3.fromRGB(160, 100, 230)
                
                -- Draggable logic
                local dragging = false
                local dragStartPos = nil
                local dragThreshold = 10
                local pressTime = 0
                
                button.InputBegan:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
                        dragStartPos = input.Position
                        dragging = false
                        pressTime = tick()
                    end
                end)
                
                button.InputChanged:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement then
                        if dragStartPos and (input.Position - dragStartPos).Magnitude > dragThreshold then
                            dragging = true
                        end
                    end
                end)
                
                button.InputEnded:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
                        local holdDuration = tick() - pressTime
                        if not dragging and holdDuration < 1 then
                            -- Execute Kyoto combo
                            local args1 = {
                                [1] = {
                                    ["Tool"] = player.Backpack:FindFirstChild("Flowing Water"),
                                    ["Goal"] = "Console Move"
                                }
                            }
                            player.Character.Communicate:FireServer(unpack(args1))
                            
                            task.wait(2.15)
                            
                            local char = player.Character
                            if char and char:FindFirstChild("HumanoidRootPart") then
                                local hrp = char.HumanoidRootPart
                                local forward = hrp.CFrame.LookVector.Unit
                                local distance = 20
                                local goalPos = hrp.Position + forward * distance
                                local tween = game:GetService("TweenService"):Create(hrp, TweenInfo.new(0.1), {
                                    CFrame = CFrame.new(goalPos, goalPos + forward)
                                })
                                tween:Play()
                                tween.Completed:Wait()
                                hrp.CFrame = hrp.CFrame * CFrame.Angles(0, math.rad(180), 0)
                                
                                -- Lethal Whirlwind Stream
                                local args = {
                                    [1] = {
                                        ["Tool"] = player.Backpack:FindFirstChild("Lethal Whirlwind Stream"),
                                        ["Goal"] = "Console Move"
                                    }
                                }
                                player.Character.Communicate:FireServer(unpack(args))
                            end
                        end
                        
                        dragStartPos = nil
                        dragging = false
                    end
                end)
                
                -- Store reference
                _G.KyotoGui = screenGui
            else
                if _G.KyotoGui then
                    _G.KyotoGui:Destroy()
                    _G.KyotoGui = nil
                end
            end
        end
    })
    
    -- Auto Farm (Fixed)
    combatSection:AddToggle({
        Name = "Auto Farm",
        Flag = "auto_farm",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.AutoFarm = enabled
            if enabled then
                pcall(function()
                    loadstring(game:HttpGet("https://raw.githubusercontent.com/Cyborg883/TSB/refs/heads/main/AutoFarm"))()
                end)
            end
        end
    })
end

-- CHARACTERS TAB
do
    local characterSection = CharCustomization:DrawSection({
        Name = "Characters",
        Position = "left"
    })
    
    local garouSection = CharCustomization:DrawSection({
        Name = "Garou Features",
        Position = "right"
    })
    
    characterSection:AddDropdown({
        Name = "Character Preset",
        Values = {"None", "Garou", "Gojo", "KJ", "Soul Reaper"},
        Default = "None",
        Flag = "character_preset",
        Callback = function(selected)
            _G.FeatureStates.CharacterPreset = selected
        end
    })
    
    garouSection:AddToggle({
        Name = "Void Kill",
        Flag = "void_kill",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.VoidKill = enabled
            if enabled then
                -- Create instruction UI
                local guideUI = Instance.new("ScreenGui")
                guideUI.Name = "VoidKillGuide"
                guideUI.ResetOnSpawn = false
                guideUI.Parent = game.Players.LocalPlayer.PlayerGui
                
                local frame = Instance.new("Frame")
                frame.Size = UDim2.new(0.4, 0, 0.3, 0)
                frame.Position = UDim2.new(0.5, 0, 0.5, 0)
                frame.AnchorPoint = Vector2.new(0.5, 0.5)
                frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
                frame.BorderSizePixel = 0
                frame.BackgroundTransparency = 0.2
                frame.Parent = guideUI
                
                local title = Instance.new("TextLabel")
                title.Size = UDim2.new(1, 0, 0.2, 0)
                title.Text = "VOID KILL INSTRUCTIONS"
                title.Font = Enum.Font.GothamBold
                title.TextSize = 24
                title.TextColor3 = Color3.new(1, 1, 1)
                title.BackgroundTransparency = 1
                title.Parent = frame
                
                local instructions = Instance.new("TextLabel")
                instructions.Size = UDim2.new(0.9, 0, 0.6, 0)
                instructions.Position = UDim2.new(0.05, 0, 0.3, 0)
                instructions.Text = "1. Select 'Garou' as your character preset\n2. Use Garou's first move (Flowing Water) on an enemy\n3. When the animation plays, the enemy will instantly die\n4. This only works when Void Kill is enabled"
                instructions.Font = Enum.Font.Gotham
                instructions.TextSize = 16
                instructions.TextColor3 = Color3.new(1, 1, 1)
                instructions.BackgroundTransparency = 1
                instructions.TextWrapped = true
                instructions.Parent = frame
                
                local closeBtn = Instance.new("TextButton")
                closeBtn.Size = UDim2.new(0.2, 0, 0.15, 0)
                closeBtn.Position = UDim2.new(0.4, 0, 0.85, 0)
                closeBtn.Text = "CLOSE"
                closeBtn.Font = Enum.Font.GothamBold
                closeBtn.TextSize = 16
                closeBtn.TextColor3 = Color3.new(1, 1, 1)
                closeBtn.BackgroundColor3 = Color3.fromRGB(100, 0, 0)
                closeBtn.Parent = frame
                
                closeBtn.MouseButton1Click:Connect(function()
                    guideUI:Destroy()
                end)
                
                -- Actual Void Kill implementation
                workspace.FallenPartsDestroyHeight = 0/0
                local animations = {
                    ["rbxassetid://12273188754"] = 1.31,
                }
                
                function findAnimation(t, a)
                    for i, v in pairs(t) do
                        if i == a then
                            return i
                        end
                    end
                    return false
                end
                
                local plr = game.Players.LocalPlayer
                if getgenv().loop then
                    coroutine.close(getgenv().loop)
                    getgenv().loop = nil
                end
                
                getgenv().loop = coroutine.create(function()
                    local dothetech = false
                    local lastcf
                    while task.wait() do
                        local character = plr.Character
                        if character and character:FindFirstChild("Humanoid") and character.Humanoid.Health > 0 then
                            local animate = character.Humanoid.Animator
                            for i, v in pairs(animate:GetPlayingAnimationTracks()) do
                                if findAnimation(animations, v.Animation.AnimationId) then
                                    task.wait(animations[v.Animation.AnimationId])
                                    dothetech = true
                                    lastcf = character.HumanoidRootPart.CFrame
                                    v.Stopped:Connect(function()
                                        dothetech = false
                                    end)
                                    repeat wait()
                                        workspace.Camera.CameraType = Enum.CameraType.Scriptable
                                        character.HumanoidRootPart.CFrame = CFrame.new(0,-300,0)
                                        character.HumanoidRootPart.AssemblyLinearVelocity = Vector3.zero
                                        character.HumanoidRootPart.AssemblyAngularVelocity = Vector3.zero
                                    until not dothetech
                                    task.wait(0.1)
                                    character.HumanoidRootPart.CFrame = lastcf
                                    workspace.Camera.CameraType = Enum.CameraType.Custom
                                    workspace.Camera.CameraSubject = character.Humanoid
                                    task.wait(1)
                                end
                            end
                        end
                    end
                end)
                coroutine.resume(getgenv().loop)
            else
                if getgenv().loop then
                    coroutine.close(getgenv().loop)
                    getgenv().loop = nil
                end
                workspace.FallenPartsDestroyHeight = -500
            end
        end
    })
    
    garouSection:AddToggle({
        Name = "Standing Pose",
        Flag = "standing_pose",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.StandingPose = enabled
            if enabled then
                pcall(function()
                    loadstring(game:HttpGet("https://raw.githubusercontent.com/Kietba/Kietba/refs/heads/main/Idiea"))()
                end)
            end
        end
    })
    
    garouSection:AddToggle({
        Name = "Soul Reaper Mode",
        Flag = "reaper_mode",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.ReaperMode = enabled
            if enabled then
                local plr = game.Players.LocalPlayer
                local char = plr.Character
                
                if char then
                    -- Apply reaper effects
                    local highlight = Instance.new("Highlight")
                    highlight.FillColor = Color3.fromRGB(80, 80, 80)
                    highlight.FillTransparency = 0.3
                    highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
                    highlight.OutlineTransparency = 0
                    highlight.Adornee = char
                    highlight.Parent = char
                    
                    SoulsHub:Notify("Soul Reaper Mode activated! Use M1 for special attacks.", 3)
                else
                    SoulsHub:Notify("You need a character to use Soul Reaper Mode!", 3)
                    _G.FeatureStates.ReaperMode = false
                end
            end
        end
    })
    
    characterSection:AddToggle({
        Name = "KJ Ravage",
        Flag = "kj_ravage",
        Default = false,
        Callback = function(enabled)
            if enabled then
                local player = game.Players.LocalPlayer
                repeat wait() until player.Character.Humanoid
                local humanoid = player.Character.Humanoid
                local character = player.Character or player.CharacterAdded:Wait()
                local UserInputService = game:GetService("UserInputService")
                local anim = Instance.new("Animation")
                anim.AnimationId = "rbxassetid://16945573694"
                local playAnim = humanoid:LoadAnimation(anim)
                anim.AnimationId = "rbxassetid://0"
                playAnim:Play()
                wait(0.7)
                local anim2 = Instance.new("Animation")
                anim2.AnimationId = "rbxassetid://16945550029"
                local playAnim2 = humanoid:LoadAnimation(anim2)
                anim2.AnimationId = "rbxassetid://0"
                playAnim2:Play()
                local soundeffect = Instance.new("Sound")
                soundeffect.SoundId = "rbxassetid://17325540665"
                soundeffect.Parent = game.Players.LocalPlayer.Character.Torso
                soundeffect:Play()
                soundeffect.Volume = 1
                local hit1 = game.ReplicatedStorage.Resources.KJEffects["HitParticles"].Hit:Clone()
                hit1.Parent = game.Players.LocalPlayer.Character["Right Arm"]
                for _, child in ipairs(hit1:GetChildren()) do
                    if child:IsA("ParticleEmitter") then
                        child:Emit(1)
                    end
                end
                wait(1.3)
                local soundeffect = Instance.new("Sound")
                soundeffect.SoundId = "rbxassetid://17325540665"
                soundeffect.Parent = game.Players.LocalPlayer.Character.Torso
                soundeffect:Play()
                soundeffect.Volume = 1
                local hit1 = game.ReplicatedStorage.Resources.KJEffects["HitParticles"].Hit:Clone()
                hit1.Parent = game.Players.LocalPlayer.Character["Left Arm"]
                for _, child in ipairs(hit1:GetChildren()) do
                    if child:IsA("ParticleEmitter") then
                        child:Emit(1)
                    end
                end
                wait(0.4)
                local soundeffect = Instance.new("Sound")
                soundeffect.SoundId = "rbxassetid://17325540665"
                soundeffect.Parent = game.Players.LocalPlayer.Character.Torso
                soundeffect:Play()
                soundeffect.Volume = 1
                local hit1 = game.ReplicatedStorage.Resources.KJEffects["HitParticles"].Hit:Clone()
                hit1.Parent = game.Players.LocalPlayer.Character["Right Arm"]
                for _, child in ipairs(hit1:GetChildren()) do
                    if child:IsA("ParticleEmitter") then
                        child:Emit(1)
                    end
                end
            end
        end
    })
    
    characterSection:AddToggle({
        Name = "Gojo Reversal Red",
        Flag = "gojo_reversal",
        Default = false,
        Callback = function(enabled)
            if enabled then
                local player = game.Players.LocalPlayer
                repeat wait() until player.Character.Humanoid
                local humanoid = player.Character.Humanoid
                local character = player.Character or player.CharacterAdded:Wait()
                local UserInputService = game:GetService("UserInputService")
                local anim = Instance.new("Animation")
                anim.AnimationId = "rbxassetid://13073745835"
                local playAnim = humanoid:LoadAnimation(anim)
                playAnim:Play()
                local red1 = game.ReplicatedStorage.Resources.FiveSeasonsFX["CharFX"].ArmEnabled:Clone()
                red1.Parent = game.Players.LocalPlayer.Character["Right Arm"]
                for _, child in ipairs(red1:GetChildren()) do
                    if child:IsA("ParticleEmitter") then
                        child:Emit(5)
                    end
                end
                wait(0.25)
                local stoic1 = game.ReplicatedStorage.Resources.StoicBomb["pre"].Part.Attachment:Clone()
                stoic1.Parent = game.Players.LocalPlayer.Character["Right Arm"]
                for _, child in ipairs(stoic1:GetChildren()) do
                    if child:IsA("ParticleEmitter") then
                        child:Emit(1)
                    end
                end
                wait(0.1)
                local stoic2 = game.ReplicatedStorage.Resources.StoicBomb["Main"].Part.Attachment:Clone()
                stoic2.Parent = game.Players.LocalPlayer.Character["Right Arm"]
                for _, child in ipairs(stoic2:GetChildren()) do
                    if child:IsA("ParticleEmitter") then
                        child:Emit(1)
                    end
                end
                wait(0.1)
                red1:Destroy()
                stoic1:Destroy()
                stoic2:Destroy()
                local final1 = game.ReplicatedStorage.Resources.KJEffects["KJWallCombo"].FinalImpact.Attachment:Clone()
                final1.Parent = game.Players.LocalPlayer.Character["Right Arm"]
                for _, child in ipairs(final1:GetChildren()) do
                    if child:IsA("ParticleEmitter") then
                        child:Emit(1)
                    end
                end
                local final2 = game.ReplicatedStorage.Resources.KJEffects["KJWallCombo"].FinalImpact.Origin:Clone()
                final2.Parent = game.Players.LocalPlayer.Character["Right Arm"]
                for _, child in ipairs(final2:GetChildren()) do
                    if child:IsA("ParticleEmitter") then
                        child:Emit(1)
                    end
                end
            end
        end
    })
end

-- ESP & VISUALS TAB
do
    local espSection = ESPVisuals:DrawSection({
        Name = "Player ESP",
        Position = "left"
    })
    
    local highlightSection = ESPVisuals:DrawSection({
        Name = "Visual Enhancements",
        Position = "right"
    })
    
    espSection:AddToggle({
        Name = "ESP Names",
        Flag = "esp_names",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.ESPNames = enabled
            if enabled then
                local function addEspToCharacter(char, playerName)
                    if not char:FindFirstChild("Head") then return end
                    if not char.Head:FindFirstChild("ESP_Name") then
                        local bb = Instance.new("BillboardGui")
                        bb.Name = "ESP_Name"
                        bb.Size = UDim2.new(0, 100, 0, 30)
                        bb.StudsOffset = Vector3.new(0, 2, 0)
                        bb.AlwaysOnTop = true
                        bb.Adornee = char.Head
                        bb.Parent = char.Head
                        local label = Instance.new("TextLabel")
                        label.Size = UDim2.new(1, 0, 1, 0)
                        label.BackgroundTransparency = 1
                        label.Text = playerName
                        label.TextColor3 = Color3.new(1, 1, 1)
                        label.TextScaled = true
                        label.Font = Enum.Font.SourceSansBold
                        label.Parent = bb
                    end
                end
                
                local function enableEspNameForPlayer(player)
                    if player == game.Players.LocalPlayer then return end
                    if player.Character then
                        addEspToCharacter(player.Character, player.Name)
                    end
                    player.CharacterAdded:Connect(function(char)
                        wait(1)
                        addEspToCharacter(char, player.Name)
                    end)
                end
                
                for _, player in ipairs(game.Players:GetPlayers()) do
                    enableEspNameForPlayer(player)
                end
                
                game.Players.PlayerAdded:Connect(enableEspNameForPlayer)
            else
                for _, player in ipairs(game.Players:GetPlayers()) do
                    if player.Character and player.Character:FindFirstChild("Head") then
                        local esp = player.Character.Head:FindFirstChild("ESP_Name")
                        if esp then esp:Destroy() end
                    end
                end
            end
        end
    })
    
    espSection:AddToggle({
        Name = "Highlight Enemies",
        Flag = "highlight_enemies",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.HighlightEnemies = enabled
            if enabled then
                local function applyHighlightToPlayer(player)
                    if player == game.Players.LocalPlayer then return end
                    local function createHighlight(char)
                        if not char:FindFirstChild("HighlightESP") then
                            local highlight = Instance.new("Highlight")
                            highlight.Name = "HighlightESP"
                            highlight.FillTransparency = 1
                            highlight.OutlineTransparency = 0
                            highlight.OutlineColor = Color3.fromRGB(0, 255, 0)
                            highlight.Adornee = char
                            highlight.Parent = char
                        end
                    end
                    
                    if player.Character then
                        createHighlight(player.Character)
                    end
                    
                    player.CharacterAdded:Connect(function(char)
                        char:WaitForChild("HumanoidRootPart", 5)
                        wait(1)
                        createHighlight(char)
                    end)
                end
                
                for _, p in ipairs(game.Players:GetPlayers()) do
                    applyHighlightToPlayer(p)
                end
                
                game.Players.PlayerAdded:Connect(function(p)
                    applyHighlightToPlayer(p)
                end)
            else
                for _, p in ipairs(game.Players:GetPlayers()) do
                    if p.Character then
                        local h = p.Character:FindFirstChild("HighlightESP")
                        if h then h:Destroy() end
                    end
                end
            end
        end
    })
    
    espSection:AddToggle({
        Name = "Show Health Text",
        Flag = "health_text",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.ShowHealthText = enabled
            if enabled then
                local showHealthConnections = {}
                local function createHealthDisplay(char)
                    if not char:FindFirstChild("Head") or not char:FindFirstChild("Humanoid") then return end
                    if char.Head:FindFirstChild("ESP_HealthText") then return end
                    local gui = Instance.new("BillboardGui")
                    gui.Name = "ESP_HealthText"
                    gui.Size = UDim2.new(0, 100, 0, 30)
                    gui.StudsOffset = Vector3.new(0, 3, 0)
                    gui.AlwaysOnTop = true
                    gui.Adornee = char.Head
                    gui.Parent = char.Head
                    local text = Instance.new("TextLabel")
                    text.Size = UDim2.new(1, 0, 1, 0)
                    text.BackgroundTransparency = 1
                    text.TextColor3 = Color3.fromRGB(255, 0, 0)
                    text.Font = Enum.Font.SourceSansBold
                    text.TextScaled = true
                    text.Text = "Health: 100%"
                    text.Parent = gui
                    local hum = char:FindFirstChild("Humanoid")
                    if hum then
                        text.Text = "Health: " .. math.floor((hum.Health / hum.MaxHealth) * 100) .. "%"
                        local conn = hum.HealthChanged:Connect(function()
                            text.Text = "Health: " .. math.floor((hum.Health / hum.MaxHealth) * 100) .. "%"
                        end)
                        table.insert(showHealthConnections, conn)
                    end
                end
                
                local function handlePlayerForHealth(player)
                    if player == game.Players.LocalPlayer then return end
                    local function onCharAdded(char)
                        wait(0.5)
                        createHealthDisplay(char)
                    end
                    if player.Character then
                        onCharAdded(player.Character)
                    end
                    local charConn = player.CharacterAdded:Connect(onCharAdded)
                    table.insert(showHealthConnections, charConn)
                end
                
                for _, p in ipairs(game.Players:GetPlayers()) do
                    handlePlayerForHealth(p)
                end
                
                local joinConn = game.Players.PlayerAdded:Connect(handlePlayerForHealth)
                table.insert(showHealthConnections, joinConn)
            else
                for _, p in ipairs(game.Players:GetPlayers()) do
                    if p.Character and p.Character:FindFirstChild("Head") then
                        local gui = p.Character.Head:FindFirstChild("ESP_HealthText")
                        if gui then gui:Destroy() end
                    end
                end
            end
        end
    })
    
    highlightSection:AddToggle({
        Name = "Highlight Dummies",
        Flag = "highlight_dummies",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.HighlightDummies = enabled
            if enabled then
                for _, npc in pairs(workspace:WaitForChild("Live"):GetChildren()) do
                    if npc:IsA("Model") and npc.Name == "Weakest Dummy" then
                        if not npc:FindFirstChild("_HighlightDummyTag") then
                            local h = Instance.new("Highlight")
                            h.Name = "_HighlightDummyTag"
                            h.Adornee = npc
                            h.FillTransparency = 1
                            h.OutlineColor = Color3.fromRGB(170, 0, 255)
                            h.OutlineTransparency = 0
                            h.Parent = npc
                        end
                    end
                end
            else
                for _, npc in pairs(workspace:WaitForChild("Live"):GetChildren()) do
                    if npc:IsA("Model") and npc.Name == "Weakest Dummy" then
                        local h = npc:FindFirstChild("_HighlightDummyTag")
                        if h then
                            h:Destroy()
                        end
                    end
                end
            end
        end
    })
    
    highlightSection:AddToggle({
        Name = "Show Tracers",
        Flag = "tracers",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.ShowTracers = enabled
            if enabled then
                local tracerConns = {}
                local tracerLines = {}
                local function createTracerForPlayer(player)
                    if player == game.Players.LocalPlayer then return end
                    local function updateLine()
                        local char = player.Character
                        local myChar = game.Players.LocalPlayer.Character
                        if char and char:FindFirstChild("HumanoidRootPart") and myChar and myChar:FindFirstChild("HumanoidRootPart") then
                            local line = tracerLines[player]
                            if not line then
                                line = Instance.new("Beam")
                                local a0 = Instance.new("Attachment")
                                local a1 = Instance.new("Attachment")
                                a0.Name = "TracerA0"
                                a1.Name = "TracerA1"
                                a0.Parent = myChar.HumanoidRootPart
                                a1.Parent = char.HumanoidRootPart
                                line.Attachment0 = a0
                                line.Attachment1 = a1
                                line.Color = ColorSequence.new(Color3.fromRGB(0, 255, 0))
                                line.Width0 = 1
                                line.Width1 = 1
                                line.FaceCamera = true
                                line.Parent = a0
                                tracerLines[player] = line
                            end
                        end
                    end
                    if player.Character then
                        updateLine()
                    end
                    local conn1 = player.CharacterAdded:Connect(function()
                        wait(1)
                        updateLine()
                    end)
                    table.insert(tracerConns, conn1)
                end
                
                for _, p in ipairs(game.Players:GetPlayers()) do
                    createTracerForPlayer(p)
                end
                
                local conn = game.Players.PlayerAdded:Connect(createTracerForPlayer)
                table.insert(tracerConns, conn)
            else
                for _, line in pairs(tracerLines or {}) do
                    if line and line.Parent then
                        local a0 = line.Attachment0
                        local a1 = line.Attachment1
                        if a0 then a0:Destroy() end
                        if a1 then a1:Destroy() end
                        line:Destroy()
                    end
                end
            end
        end
    })
end

-- AIM & PROTECTION TAB
do
    local aimSection = AimProtection:DrawSection({
        Name = "Aim Features",
        Position = "left"
    })
    
    local protectionSection = AimProtection:DrawSection({
        Name = "Protection",
        Position = "right"
    })
    
    -- Aimlock (Fixed)
    aimSection:AddToggle({
        Name = "Aimlock",
        Flag = "aimlock_enabled",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.AimlockEnabled = enabled
            if enabled then
                -- Create custom GUI
                local player = game.Players.LocalPlayer
                local gui = Instance.new("ScreenGui", player.PlayerGui)
                gui.Name = "AimLockGUI"
                gui.ResetOnSpawn = false
                
                local mainFrame = Instance.new("Frame", gui)
                mainFrame.Size = UDim2.new(0, 220, 0, 180)
                mainFrame.Position = UDim2.new(0, 10, 0, 10)
                mainFrame.BackgroundColor3 = Color3.new(0.1, 0.1, 0.15)
                mainFrame.BackgroundTransparency = 0.2
                mainFrame.Active = true
                mainFrame.Draggable = true
                
                -- Styling
                Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 10)
                Instance.new("UIStroke", mainFrame).Color = Color3.fromRGB(120, 80, 200)
                
                -- Title
                local title = Instance.new("TextLabel", mainFrame)
                title.Size = UDim2.new(1, 0, 0.15, 0)
                title.Text = "AIMLOCK SYSTEM"
                title.TextColor3 = Color3.new(1, 1, 1)
                title.BackgroundTransparency = 1
                title.Font = Enum.Font.GothamBold
                title.TextSize = 16
                
                -- Lock Button
                local btn = Instance.new("TextButton", mainFrame)
                btn.Size = UDim2.new(1, 0, 0.15, 0)
                btn.Position = UDim2.new(0, 0, 0.15, 0)
                btn.Text = "STATUS: OFF"
                btn.TextColor3 = Color3.new(1, 1, 1)
                btn.BackgroundTransparency = 1
                btn.Font = Enum.Font.GothamBold
                btn.TextSize = 14
                
                -- Target Display
                local targetLabel = Instance.new("TextLabel", mainFrame)
                targetLabel.Size = UDim2.new(1, 0, 0.15, 0)
                targetLabel.Position = UDim2.new(0, 0, 0.3, 0)
                targetLabel.Text = "TARGET: NONE"
                targetLabel.TextColor3 = Color3.new(1, 1, 1)
                targetLabel.BackgroundTransparency = 1
                targetLabel.Font = Enum.Font.Gotham
                targetLabel.TextSize = 14
                
                -- Offset Control
                local offsetLabel = Instance.new("TextLabel", mainFrame)
                offsetLabel.Size = UDim2.new(0.4, 0, 0.15, 0)
                offsetLabel.Position = UDim2.new(0.05, 0, 0.45, 0)
                offsetLabel.Text = "OFFSET:"
                offsetLabel.TextColor3 = Color3.new(1, 1, 1)
                offsetLabel.BackgroundTransparency = 1
                offsetLabel.Font = Enum.Font.Gotham
                offsetLabel.TextSize = 12
                
                local offsetInput = Instance.new("TextBox", mainFrame)
                offsetInput.Size = UDim2.new(0.45, 0, 0.15, 0)
                offsetInput.Position = UDim2.new(0.5, 0, 0.45, 0)
                offsetInput.Text = "0.0001"
                offsetInput.PlaceholderText = "Enter value (e.g. 0.0001)"
                offsetInput.TextColor3 = Color3.new(1, 1, 1)
                offsetInput.BackgroundColor3 = Color3.new(0.2, 0.2, 0.3)
                offsetInput.BackgroundTransparency = 0.1
                offsetInput.TextSize = 12
                
                -- Body Part Selection
                local targetBodyPart = "Head"
                local targetPartDropdown = Instance.new("TextButton", mainFrame)
                targetPartDropdown.Size = UDim2.new(0.45, 0, 0.15, 0)
                targetPartDropdown.Position = UDim2.new(0.5, 0, 0.6, 0)
                targetPartDropdown.Text = "HEAD"
                targetPartDropdown.TextColor3 = Color3.new(1, 1, 1)
                targetPartDropdown.BackgroundColor3 = Color3.new(0.2, 0.2, 0.3)
                targetPartDropdown.BackgroundTransparency = 0.1
                targetPartDropdown.TextSize = 12
                
                -- Center Dot
                local dot = Instance.new("Frame", gui)
                dot.Size = UDim2.new(0, 8, 0, 8)
                dot.AnchorPoint = Vector2.new(0.5, 0.5)
                dot.Position = UDim2.new(0.5, 0, 0.5, 0)
                dot.BackgroundColor3 = Color3.new(1, 0.2, 0.2)
                dot.BorderSizePixel = 0
                
                -- State variables
                local armed = false
                local tgt = nil
                local verticalAimOffset = 0.0001
                local targetBodyParts = {"Head", "Chest", "Legs"}
                
                -- Button functionality
                btn.MouseButton1Click:Connect(function()
                    armed = not armed
                    btn.Text = "STATUS: " .. (armed and "ON" or "OFF")
                    if not armed then
                        tgt = nil
                        targetLabel.Text = "TARGET: NONE"
                    end
                end)
                
                -- Offset input handling
                offsetInput.FocusLost:Connect(function(enterPressed)
                    if enterPressed then
                        local num = tonumber(offsetInput.Text)
                        if num then
                            verticalAimOffset = num
                        else
                            offsetInput.Text = tostring(verticalAimOffset)
                        end
                    end
                end)
                
                -- Body part cycling
                targetPartDropdown.MouseButton1Click:Connect(function()
                    local currentIndex = table.find(targetBodyParts, targetBodyPart) or 1
                    local newIndex = (currentIndex % #targetBodyParts) + 1
                    targetBodyPart = targetBodyParts[newIndex]
                    targetPartDropdown.Text = targetBodyPart
                    tgt = nil -- Reset target when changing body part
                end)
                
                -- Target finding function
                local function findTarget()
                    local cam = workspace.CurrentCamera
                    if not cam then return nil end
                    
                    local bestTarget = nil
                    local cameraPos = cam.CFrame.Position
                    
                    for _, player in ipairs(game.Players:GetPlayers()) do
                        if player ~= game.Players.LocalPlayer and player.Character then
                            local char = player.Character
                            local targetPart = nil
                            
                            if targetBodyPart == "Head" then
                                targetPart = char:FindFirstChild("Head")
                            elseif targetBodyPart == "Chest" then
                                targetPart = char:FindFirstChild("UpperTorso") or char:FindFirstChild("Torso")
                            elseif targetBodyPart == "Legs" then
                                targetPart = char:FindFirstChild("LowerTorso") or char:FindFirstChild("HumanoidRootPart")
                            end
                            
                            if targetPart then
                                local direction = (targetPart.Position - cameraPos).Unit
                                local angle = math.deg(math.acos(cam.CFrame.LookVector:Dot(direction)))
                                
                                if angle < 25 and (targetPart.Position - cameraPos).Magnitude < 500 then
                                    if not bestTarget or (targetPart.Position - cameraPos).Magnitude < (bestTarget.Position - cameraPos).Magnitude then
                                        bestTarget = targetPart
                                    end
                                end
                            end
                        end
                    end
                    
                    return bestTarget
                end
                
                -- Main aiming loop
                local renderConnection
                renderConnection = game:GetService("RunService").RenderStepped:Connect(function()
                    if not enabled then return end
                    
                    if armed then
                        if not tgt or not tgt.Parent then
                            tgt = findTarget()
                        end
                        
                        if tgt then
                            local cam = workspace.CurrentCamera
                            if cam then
                                local targetPos = tgt.Position
                                local camPos = cam.CFrame.Position
                                local direction = (targetPos - camPos).Unit
                                local newLook = (direction + Vector3.new(0, verticalAimOffset, 0)).Unit
                                cam.CFrame = CFrame.lookAt(camPos, camPos + newLook * 100)
                                targetLabel.Text = "TARGET: " .. tgt.Parent.Name
                            end
                        else
                            targetLabel.Text = "TARGET: NONE"
                        end
                    end
                end)
                
                -- Cleanup on respawn
                local charConnection
                charConnection = game.Players.LocalPlayer.CharacterAdded:Connect(function()
                    wait(0.5)
                    if gui.Parent then
                        gui:Destroy()
                    end
                end)
            else
                -- Clean up everything
                local player = game.Players.LocalPlayer
                if player.PlayerGui:FindFirstChild("AimLockGUI") then
                    player.PlayerGui.AimLockGUI:Destroy()
                end
            end
        end
    })
    
    -- FLING (Fixed)
    protectionSection:AddToggle({
        Name = "FLING",
        Flag = "fling_protection",
        Default = false,
        Callback = function(enabled)
            _G.FeatureStates.FlingProtection = enabled
            if enabled then
                -- Create instruction UI
                local guideUI = Instance.new("ScreenGui")
                guideUI.Name = "FlingGuide"
                guideUI.ResetOnSpawn = false
                guideUI.Parent = game.Players.LocalPlayer.PlayerGui
                
                local frame = Instance.new("Frame")
                frame.Size = UDim2.new(0.4, 0, 0.3, 0)
                frame.Position = UDim2.new(0.5, 0, 0.5, 0)
                frame.AnchorPoint = Vector2.new(0.5, 0.5)
                frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
                frame.BorderSizePixel = 0
                frame.BackgroundTransparency = 0.2
                frame.Parent = guideUI
                
                local title = Instance.new("TextLabel")
                title.Size = UDim2.new(1, 0, 0.2, 0)
                title.Text = "HOW TO USE FLING"
                title.Font = Enum.Font.GothamBold
                title.TextSize = 24
                title.TextColor3 = Color3.new(1, 1, 1)
                title.BackgroundTransparency = 1
                title.Parent = frame
                
                local instructions = Instance.new("TextLabel")
                instructions.Size = UDim2.new(0.9, 0, 0.6, 0)
                instructions.Position = UDim2.new(0.05, 0, 0.3, 0)
                instructions.Text = "1. equipe garou and just touch anyone"
                instructions.Font = Enum.Font.Gotham
                instructions.TextSize = 16
                instructions.TextColor3 = Color3.new(1, 1, 1)
                instructions.BackgroundTransparency = 1
                instructions.TextWrapped = true
                instructions.Parent = frame
                
                local closeBtn = Instance.new("TextButton")
                closeBtn.Size = UDim2.new(0.2, 0, 0.15, 0)
                closeBtn.Position = UDim2.new(0.4, 0, 0.85, 0)
                closeBtn.Text = "CLOSE"
                closeBtn.Font = Enum.Font.GothamBold
                closeBtn.TextSize = 16
                closeBtn.TextColor3 = Color3.new(1, 1, 1)
                closeBtn.BackgroundColor3 = Color3.fromRGB(100, 0, 0)
                closeBtn.Parent = frame
                
                closeBtn.MouseButton1Click:Connect(function()
                    guideUI:Destroy()
                end)
                
                -- Actual FLING implementation
                local p = game.Players.LocalPlayer
                local rs = game:GetService("RunService")
                local rep = game:GetService("ReplicatedStorage")
                
                if not rep:FindFirstChild("fling_detect") then
                    local dec = Instance.new("Decal")
                    dec.Name = "fling_detect"
                    dec.Parent = rep
                end
                
                coroutine.wrap(function()
                    local c, hrp, vel, mv = nil, nil, nil, 0.1
                    while _G.FeatureStates.FlingProtection do
                        rs.Heartbeat:Wait()
                        c = p.Character
                        hrp = c and c:FindFirstChild("HumanoidRootPart")
                        if hrp then
                            vel = hrp.Velocity
                            hrp.Velocity = vel * 10000 + Vector3.new(0, 10000, 0)
                            rs.RenderStepped:Wait()
                            hrp.Velocity = vel
                            rs.Stepped:Wait()
                            hrp.Velocity = vel + Vector3.new(0, mv, 0)
                            mv = -mv
                        end
                    end
                end)()
            end
        end
    })
end

-- SERVER & ADMIN TAB
do
    local serverSection = ServerAdmin:DrawSection({
        Name = "Server Tools",
        Position = "left"
    })
    
    local adminSection = ServerAdmin:DrawSection({
        Name = "Admin Tools",
        Position = "right"
    })
    
    serverSection:AddButton({
        Name = "Rejoin Server",
        Callback = function()
            local TeleportService = game:GetService("TeleportService")
            local player = game.Players.LocalPlayer
            
            local screenGui = Instance.new("ScreenGui")
            screenGui.Parent = player:WaitForChild("PlayerGui")
            local label = Instance.new("TextLabel")
            label.Parent = screenGui
            label.Size = UDim2.new(0.3, 0, 0.2, 0)
            label.Position = UDim2.new(0.35, 0, 0.4, 0)
            label.TextScaled = true
            label.BackgroundTransparency = 1
            label.TextColor3 = Color3.new(1, 1, 1)
            label.Font = Enum.Font.GothamBold
            
            for i = 5, 1, -1 do
                label.Text = "Rejoining in " .. i .. "..."
                task.wait(1)
            end
            
            screenGui:Destroy()
            TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, player)
        end
    })
    
    serverSection:AddButton({
        Name = "Server Hop",
        Callback = function()
            local TeleportService = game:GetService("TeleportService")
            local HttpService = game:GetService("HttpService")
            local player = game.Players.LocalPlayer
            local placeId = game.PlaceId
            
            local screenGui = Instance.new("ScreenGui")
            screenGui.Parent = player:WaitForChild("PlayerGui")
            local label = Instance.new("TextLabel")
            label.Parent = screenGui
            label.Size = UDim2.new(0.3, 0, 0.2, 0)
            label.Position = UDim2.new(0.35, 0, 0.4, 0)
            label.TextScaled = true
            label.BackgroundTransparency = 1
            label.TextColor3 = Color3.new(1, 1, 1)
            label.Font = Enum.Font.GothamBold
            
            for i = 5, 1, -1 do
                label.Text = "Hopping in " .. i .. "..."
                task.wait(1)
            end
            
            screenGui:Destroy()
            
            local function getRandomServer()
                local servers = {}
                local success, response = pcall(function()
                    return HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..placeId.."/servers/Public?sortOrder=Asc&limit=100"))
                end)
                if success and response and response.data then
                    for _, server in pairs(response.data) do
                        if server.playing < server.maxPlayers and server.id ~= game.JobId then
                            table.insert(servers, server.id)
                        end
                    end
                end
                return #servers > 0 and servers[math.random(1, #servers)] or nil
            end
            
            local target = getRandomServer()
            if target then
                TeleportService:TeleportToPlaceInstance(placeId, target, player)
            else
                SoulsHub:Notify("No other servers found", 3)
            end
        end
    })
    
    serverSection:AddButton({
        Name = "Small Server Hop",
        Callback = function()
            local TeleportService = game:GetService("TeleportService")
            local HttpService = game:GetService("HttpService")
            local player = game.Players.LocalPlayer
            local placeId = game.PlaceId
            
            local screenGui = Instance.new("ScreenGui")
            screenGui.Parent = player:WaitForChild("PlayerGui")
            local label = Instance.new("TextLabel")
            label.Parent = screenGui
            label.Size = UDim2.new(0.4, 0, 0.2, 0)
            label.Position = UDim2.new(0.3, 0, 0.4, 0)
            label.TextScaled = true
            label.BackgroundTransparency = 1
            label.TextColor3 = Color3.new(1, 1, 1)
            label.Font = Enum.Font.GothamBold
            
            for i = 5, 1, -1 do
                label.Text = "Finding small server in: " .. i
                task.wait(1)
            end
            
            screenGui:Destroy()
            
            local function getSmallServer()
                local servers = {}
                local cursor = nil
                for _ = 1, 5 do
                    local url = "https://games.roblox.com/v1/games/"..placeId.."/servers/Public?sortOrder=Asc&limit=100"
                    if cursor then url = url.."&cursor="..cursor end
                    local success, response = pcall(function()
                        return HttpService:JSONDecode(game:HttpGet(url))
                    end)
                    if success and response and response.data then
                        for _, server in ipairs(response.data) do
                            if server.playing < 5 and server.id ~= game.JobId then
                                table.insert(servers, server.id)
                            end
                        end
                        if response.nextPageCursor then
                            cursor = response.nextPageCursor
                        else
                            break
                        end
                    else
                        break
                    end
                end
                return #servers > 0 and servers[math.random(1, #servers)] or nil
            end
            
            local target = getSmallServer()
            if target then
                TeleportService:TeleportToPlaceInstance(placeId, target, player)
            else
                SoulsHub:Notify("No small servers found", 3)
            end
        end
    })
    
    serverSection:AddButton({
        Name = "Exit Server",
        Callback = function()
            local player = game.Players.LocalPlayer
            local gui = Instance.new("ScreenGui")
            gui.Parent = player:WaitForChild("PlayerGui")
            gui.ResetOnSpawn = false
            
            local frame = Instance.new("Frame")
            frame.Parent = gui
            frame.Size = UDim2.new(0.5, 0, 0.3, 0)
            frame.Position = UDim2.new(0.25, 0, 0.35, 0)
            frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
            frame.BorderSizePixel = 0
            frame.BackgroundTransparency = 0.1
            frame.AnchorPoint = Vector2.new(0.5, 0.5)
            frame.ClipsDescendants = true
            
            local title = Instance.new("TextLabel")
            title.Parent = frame
            title.Size = UDim2.new(1, 0, 0.4, 0)
            title.Position = UDim2.new(0, 0, 0, 0)
            title.Text = "Do you want to exit server?"
            title.TextColor3 = Color3.new(1, 1, 1)
            title.BackgroundTransparency = 1
            title.TextScaled = true
            title.Font = Enum.Font.GothamBold
            
            local yesBtn = Instance.new("TextButton")
            yesBtn.Parent = frame
            yesBtn.Size = UDim2.new(0.4, 0, 0.3, 0)
            yesBtn.Position = UDim2.new(0.1, 0, 0.55, 0)
            yesBtn.Text = "Yes"
            yesBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
            yesBtn.TextColor3 = Color3.new(1, 1, 1)
            yesBtn.TextScaled = true
            yesBtn.Font = Enum.Font.GothamBold
            
            local noBtn = Instance.new("TextButton")
            noBtn.Parent = frame
            noBtn.Size = UDim2.new(0.4, 0, 0.3, 0)
            noBtn.Position = UDim2.new(0.5, 0, 0.55, 0)
            noBtn.Text = "No"
            noBtn.BackgroundColor3 = Color3.fromRGB(50, 200, 50)
            noBtn.TextColor3 = Color3.new(1, 1, 1)
            noBtn.TextScaled = true
            noBtn.Font = Enum.Font.GothamBold
            
            yesBtn.MouseButton1Click:Connect(function()
                player:Kick("You exited the server.")
                gui:Destroy()
            end)
            
            noBtn.MouseButton1Click:Connect(function()
                gui:Destroy()
            end)
        end
    })
    
    adminSection:AddButton({
        Name = "Infinite Yield",
        Callback = function()
            pcall(function()
                loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))()
            end)
        end
    })
    
    adminSection:AddButton({
        Name = "Nameless Admin",
        Callback = function()
            pcall(function()
                loadstring(game:HttpGet("https://github.com/FilteringEnabled/NamelessAdmin/blob/main/Source?raw=true"))()
            end)
        end
    })
end

-- CONFIG & CREDITS TAB
do
    local configSection = ConfigCredits:DrawSection({
        Name = "Configuration",
        Position = "left"
    })
    
    local creditsSection = ConfigCredits:DrawSection({
        Name = "Credits",
        Position = "right"
    })
    
    configSection:AddParagraph({
        Title = "Config Manager",
        Content = "Save and load your preferred settings for different scenarios."
    })
    
    local configManager = configSection:AddButton({
        Name = "Open Config Manager",
        Callback = function()
            Configs:Toggle()
        end
    })
    
    creditsSection:AddParagraph({
        Title = "Credits",
        Content = "SOULS HUB - Premium TSB Script\n\nDeveloped by: soulsyt_\nScript Contributors: Crazy"
    })
    
    creditsSection:AddButton({
        Name = "Copy Discord Link",
        Callback = function()
            setclipboard("https://discord.gg/soulshub")
            SoulsHub:Notify("Copied Discord link!", 3)
        end
    })
end

-- CONFIG SECTION
local Configs = Window:DrawConfig({
    Name = "Configs",
    Icon = "folder",
    Config = FileWatcher
})

Configs:Init()
Window:Draw()
